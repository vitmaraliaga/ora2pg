-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = genesis,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_persona_interes_reporte (id_persona_interes, id_persona, id_programa_estudio, id_canal_detalle, id_clasificacion, id_convocatoria_detalle, estado, id_usuario_reg, fecha_registro, id_usuario_act, fecha_actualizacion, nombre, paterno, materno, codigo, unapellido, id_persona_old, programa_nombre, programa_nombre_corto, programa_nombre_certificado, clasificacion_nombre, clasificacion_codigo, id_nivel_ensenanza, id_convocatoria, id_semestre, nivel_ensenanza_nombre, nivel_ensenanza_codigo, id_tipo_etapa, nombre_etapa, codigo_etapa, id_tipo_prioridad, prioridad_nombre, prioridad_orden, canal_detalle_valor, id_canal, campania) AS select  
pi.ID_PERSONA_INTERES,pi.ID_PERSONA,nvl(pi.ID_PROGRAMA_ESTUDIO,0)  ,pi.ID_CANAL_DETALLE,pi.ID_CLASIFICACION,pi.ID_CONVOCATORIA_DETALLE,pi.ESTADO,pi.ID_USUARIO_REG,pi.FECHA_REGISTRO,pi.ID_USUARIO_ACT,pi.FECHA_ACTUALIZACION,
p.nombre, p.paterno, p.materno, p.codigo, p.unapellido, id_persona_old,
ape.nombre programa_nombre, ape.nombre_corto programa_nombre_corto, ape.nombre_certificado programa_nombre_certificado,
tc.nombre clasificacion_nombre, tc.codigo clasificacion_codigo,
cd.id_nivel_ensenanza, cd.id_convocatoria, cd.id_semestre,
tne.nombre nivel_ensenanza_nombre, tne.codigo nivel_ensenanza_codigo,
te.id_tipo_etapa, te.nombre nombre_etapa , te.codigo codigo_etapa,
tp.id_tipo_prioridad, nvl(tp.nombre, '-') prioridad_nombre, nvl(tp.orden,0) prioridad_orden,
nvl(cdt.valor, 'Sin canal de referencia') canal_detalle_valor, nvl(to_char(cdt.id_canal), '') id_canal,
nvl(tc2.NOMBRE , 'Sin campa√±a')
FROM genesis.persona_interes pi
inner join genesis.persona p on pi.id_persona = p.id_persona
left join david.acad_programa_estudio ape on pi.id_programa_estudio = ape.id_programa_estudio
left join genesis.tipo_clasificacion tc on pi.id_clasificacion = tc.id_clasificacion
inner join genesis.convocatoria_detalle cd on pi.id_convocatoria_detalle = cd.id_convocatoria_detalle
inner join david.tipo_nivel_ensenanza tne on cd.id_nivel_Ensenanza = tne.id_nivel_ensenanza
inner join genesis.tipo_etapa te on pi.id_tipo_etapa = te.id_tipo_etapa
 left join genesis.tipo_prioridad tp on pi.id_tipo_prioridad = tp.id_tipo_prioridad
 left join genesis.canal_detalle cdt on pi.id_canal_detalle = cdt.id_canal_detalle
 LEFT JOIN genesis.TIPO_CAMPANIA tc2 ON tc2.ID_CAMPANIA = pi.ID_CAMPANIA 
      
      ;

