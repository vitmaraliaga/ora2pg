-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fc_get_cuenta_debitos (entidad bigint, ctacte bigint) RETURNS bigint AS $body$
DECLARE
 cuenta bigint;
   s_id_empresa bigint;
   s_id_tipoentidad bigint;
   s_id_empresa_ctacte bigint;

BEGIN 
      s_id_empresa := -1;
      s_id_empresa_ctacte := -1;
      s_id_tipoentidad := -1;
      
      select 
        coalesce((select id_empresa from conta_entidad where id_entidad = entidad),-1),
        coalesce((select id_empresa from conta_entidad where id_entidad = ctacte),-1),
        coalesce((select id_tipoentidad from conta_entidad where id_entidad = entidad),-1) 
        into STRICT s_id_empresa,s_id_empresa_ctacte,s_id_tipoentidad 
;

      if s_id_empresa <> -1 then

        if s_id_tipoentidad = 3 then 
          if s_id_empresa = s_id_empresa_ctacte then
            cuenta := 1136001;
          else
            cuenta := 1136010;
          end if;
        elsif s_id_tipoentidad = 4 then
          if s_id_empresa = s_id_empresa_ctacte then
            cuenta := 2136010;
          else
            cuenta := 1136010;
          end if;
        elsif s_id_tipoentidad = 12 then
          if ctacte in (11010101,21010101,31010101,41010101,51010101,61010101,71010101) then
            cuenta := 1136080;
          else
            cuenta := 1136010;
          end if;

        else
          cuenta := 2136010;
        end if;

        
        
      end if;
      RETURN(cuenta);
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fc_get_cuenta_debitos (entidad bigint, ctacte bigint) FROM PUBLIC;

