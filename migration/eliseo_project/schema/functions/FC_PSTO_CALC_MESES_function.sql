-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fc_psto_calc_meses (P_FINI timestamp(0),P_FFIN timestamp(0),P_ID_ANHO bigint) RETURNS bigint AS $body$
DECLARE

l_dato integer:=0;

BEGIN
  if coalesce(P_FINI::text, '') = '' then
    l_dato:=0;
  else
    if coalesce(P_FFIN::text, '') = '' then
      SELECT MONTHS_BETWEEN(to_date(P_ID_ANHO::text||'/12/31','yyyy/mm/dd'),P_FINI) INTO STRICT l_dato;
    else
      if P_FINI<P_FFIN then
        SELECT MONTHS_BETWEEN(P_FFIN,P_FINI) INTO STRICT l_dato;
      end if;
    end if;
	end if;

  if l_dato>12 then
    l_dato:=12;
  end if;

  if l_dato<0 then
    l_dato:=0;
  end if;

	RETURN(l_dato);
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fc_psto_calc_meses (P_FINI timestamp(0),P_FFIN timestamp(0),P_ID_ANHO bigint) FROM PUBLIC;

