-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fc_numero_texto (P_NUMERO bigint,P_SOLO_NUMERO bigint DEFAULT 0) RETURNS varchar AS $body$
DECLARE

    r_numero  varchar(200);
    t_numero bigint;
    t_millones smallint;
    t_miles	  smallint;
    t_centenas smallint;
    t_decimal smallint;

BEGIN
        t_decimal	:= mod(round((P_NUMERO)::numeric,2)*100,100);
        t_numero	:= P_NUMERO-(t_decimal/100);
        t_centenas := mod(t_numero,1000);
        t_miles	:= mod((t_numero-t_centenas)/1000,1000);
        t_millones := (t_numero-((t_miles*1000)+t_centenas))/1000000;

        if t_millones>0 then
            if t_millones=1 then
                r_numero := 'un';
            else
                r_numero := replace(trim(both FC_NUMTXT_TODO(t_millones)),'uno','un');
            end if;
            r_numero := r_numero||' millon ';
            if  t_millones > 1 then
                r_numero := trim(both r_numero)||'es ';
            end if;
        end if;

        if t_miles>0 then
            if  t_miles > 1 then
                r_numero := r_numero || replace(trim(both FC_NUMTXT_TODO(t_miles)),'uno','un');
            end if;
            r_numero := r_numero||' mil ';
        end if;
        r_numero := r_numero||trim(both FC_NUMTXT_TODO(t_centenas));

        if t_numero < 1 then
            r_numero := 'cero';
        end if;

       	IF P_SOLO_NUMERO != 1 THEN 
	        r_numero := r_numero||' con ';
	        r_numero := r_numero||trim(both to_char(t_decimal,'00'))||'/100';
       	END IF;

	 RETURN( trim(both r_numero) );
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fc_numero_texto (P_NUMERO bigint,P_SOLO_NUMERO bigint DEFAULT 0) FROM PUBLIC;

