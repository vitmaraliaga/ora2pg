-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_presupuesto (id_empresa, id_entidad, id_anho, id_mes, id_depto, id_fondo, id_cuentaaasi, id_restriccion, id_ctacte, cos_valor, pto_ingresos, pto_ejecucion, pto_gastos, pto_fondo) AS SELECT
  CONTA_ENTIDAD.ID_EMPRESA,
  CONTA_PRESUPUESTO.ID_ENTIDAD,
  CONTA_PRESUPUESTO.ID_ANHO,
  CONTA_PRESUPUESTO.ID_MES,
  CONTA_PRESUPUESTO.ID_DEPTO,
  CONTA_PRESUPUESTO.ID_FONDO,
  --CONTA_PRESUPUESTO.ID_TIPOPLAN,
  CONTA_PRESUPUESTO.ID_CUENTAAASI,
  CONTA_PRESUPUESTO.ID_RESTRICCION,
  CONTA_PRESUPUESTO.ID_CTACTE,
  cast(CONTA_PRESUPUESTO.COS_VALOR AS decimal(19, 2)) AS COS_VALOR,
  cast(CASE WHEN CONTA_PRESUPUESTO.ID_CUENTAAASI LIKE '3%' THEN CONTA_PRESUPUESTO.COS_VALOR END AS decimal(19, 2)) AS PTO_INGRESOS,                 -- Ingresos
  cast(CASE WHEN CONTA_PRESUPUESTO.ID_CUENTAAASI LIKE '4%' THEN CONTA_PRESUPUESTO.COS_VALOR END AS decimal(19, 2)) AS PTO_EJECUCION,                 -- Gastos ejecutados
  cast(CASE WHEN CONTA_PRESUPUESTO.ID_CUENTAAASI IN ('6100001', '6200001') THEN CONTA_PRESUPUESTO.COS_VALOR END AS decimal(19, 2)) AS PTO_GASTOS,  -- CONTA_PRESUPUESTO de Gastos
  cast(CASE WHEN CONTA_PRESUPUESTO.ID_CUENTAAASI IN ('6300001', '6400001') THEN CONTA_PRESUPUESTO.COS_VALOR END AS decimal(19, 2)) AS PTO_FONDO   -- CONTA_PRESUPUESTO Por Transferencia Fondos
FROM CONTA_ENTIDAD
INNER JOIN CONTA_PRESUPUESTO ON
  CONTA_ENTIDAD.ID_ENTIDAD = CONTA_PRESUPUESTO.ID_ENTIDAD;

