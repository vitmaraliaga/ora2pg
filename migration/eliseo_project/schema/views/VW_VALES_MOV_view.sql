-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_vales_mov (id_entidad, id_depto, id_anho, id_mes, id_vale, id_empleado, id_moneda, id_tipovale, id_voucher, id_mediopago, fecha, numero, nro_vale, importe, importe_me) AS SELECT
    A.ID_ENTIDAD, 
    A.ID_DEPTO, 
    A.ID_ANHO, 
    A.ID_MES,
    A.ID_VALE, 
    A.ID_EMPLEADO, 
    A.ID_MONEDA,
    A.ID_TIPOVALE,
    A.ID_VOUCHER, 
    A.ID_MEDIOPAGO,
    A.FECHA, 
    A.NUMERO,
    A.NRO_VALE,
    A.IMPORTE, 
    A.IMPORTE_ME
FROM CAJA_VALE A
WHERE A.ID_TIPOVALE=1
AND A.ESTADO='1'

UNION ALL

SELECT 
    B.ID_ENTIDAD,
    B.ID_DEPTO,
    B.ID_ANHO,
    B.ID_MES,
    B.ID_VALE,
    B.ID_EMPLEADO, 
    A.ID_MONEDA, 
    B.ID_TIPOVALE,
    A.ID_VOUCHER,
    B.ID_MEDIOPAGO,
    A.FECHA_REG AS FECHA ,
    B.NUMERO,
    B.NRO_VALE,
    COALESCE(A.IMPORTE, 0)*-1 AS IMPORTE,
    COALESCE(A.IMPORTE_ME, 0)*-1 AS IMPORTE_ME
FROM CAJA_PAGO A
INNER JOIN CAJA_VALE B ON A.ID_VALE=B.ID_VALE
WHERE B.ID_TIPOVALE=1
AND B.ESTADO='1'

UNION ALL
 
SELECT 
    B.ID_ENTIDAD,
    B.ID_DEPTO,
    B.ID_ANHO,
    B.ID_MES,
    B.ID_VALE,
    B.ID_EMPLEADO, 
    A.ID_MONEDA, 
    B.ID_TIPOVALE,
    A.ID_VOUCHER,
    B.ID_MEDIOPAGO,
    A.FECHA,
    B.NUMERO,
    B.NRO_VALE,
    COALESCE(A.IMPORTE, 0)*-1 AS IMPORTE,
    COALESCE(A.IMPORTE_ME, 0)*-1 AS IMPORTE_ME
FROM CAJA_DEPOSITO A
INNER JOIN CAJA_VALE B ON A.ID_VALE=B.ID_VALE
WHERE B.ID_TIPOVALE=1
AND B.ESTADO='1';

