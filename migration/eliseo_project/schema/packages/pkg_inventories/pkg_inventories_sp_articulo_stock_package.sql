-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_inventories,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_inventories_sp_articulo_stock (P_ID_ALMACEN bigint, P_ID_ARTICULO bigint, P_ID_ANHO bigint, P_STOCK OUT bigint, P_COSTO OUT bigint, P_MSN OUT text) AS $body$
DECLARE

        L_ARTICULO bigint;

BEGIN
            
            SELECT COUNT(ID_ARTICULO) INTO STRICT L_ARTICULO
            FROM INVENTARIO_ALMACEN_ARTICULO
            WHERE ID_ALMACEN = P_ID_ALMACEN
            AND ID_ARTICULO = P_ID_ARTICULO
            AND ID_ANHO = P_ID_ANHO;

            IF L_ARTICULO = 0 THEN
                P_STOCK := 0;
                P_COSTO :=0;
                P_MSN := 'ARTICULO NO EXISTE';
            ELSE
                SELECT coalesce(STOCK_ACTUAL,0),coalesce(COSTO,0) INTO STRICT P_STOCK, P_COSTO
                FROM INVENTARIO_ALMACEN_ARTICULO
                WHERE ID_ALMACEN = P_ID_ALMACEN
                AND ID_ARTICULO = P_ID_ARTICULO
                AND ID_ANHO = P_ID_ANHO;

                P_MSN := 'STOCK';
            END IF;
        END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_inventories_sp_articulo_stock (P_ID_ALMACEN bigint, P_ID_ARTICULO bigint, P_ID_ANHO bigint, P_STOCK OUT bigint, P_COSTO OUT bigint, P_MSN OUT text) FROM PUBLIC;
