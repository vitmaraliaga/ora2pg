-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_sales_industry,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_sales_industry_sp_migrar_venta_jesus_validar (P_ERROR OUT bigint, P_MSGERROR OUT text) AS $body$
DECLARE

        l_count bigint := 0;
        /*
        cursor saldos is
           SELECT 
          id_entidad, 
          id_depto, 
          serie,
          numero, 
          ruc_cliente, 
          razon_social_cliente,
          fecha,
          fecha_venc,
          id_comprobante,
          moneda,
          glosa,
          es_gravado,
          importe,
          importe_me,
          cuenta_cte,
          id_articulo
          from vv_importa_venta_jesus
          order by fecha;
          */
        L_ERROR bigint;
        L_MSGERROR varchar(100) :='';

    
BEGIN
            /*
            FOR sal in saldos
                LOOP
                
              SELECT count(v.id_venta) into l_count FROM VENTA v WHERE v.ID_ENTIDAD =sal.id_entidad
              --AND ID_DEPTO =sal.id_depto
              AND SERIE =sal.serie
              AND NUMERO =sal.numero;
                
                if l_count >0 then 
                     update vv_importa_venta_jesus x
                    set ya_existe='1'
                    where 1=1
                    and x.numero=sal.numero
                    and x.serie=sal.serie
                    and x.ruc_cliente=sal.ruc_cliente
                    ;
                end if;
               
        end loop;
         */
        RAISE NOTICE 'P_ERROR = %', L_ERROR;
        RAISE NOTICE 'P_MSGERROR = %', L_MSGERROR;
                
--         <<salida_rapida>>
        P_ERROR:=L_ERROR;
        P_MSGERROR:=L_MSGERROR;

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_sales_industry_sp_migrar_venta_jesus_validar (P_ERROR OUT bigint, P_MSGERROR OUT text) FROM PUBLIC;
