-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_orders,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_orders_sp_insert_pedido (P_ID_ENTIDAD bigint,P_ID_DEPTO text,P_ID_ANHO bigint,P_ID_MES bigint,P_ID_PERSONA bigint,P_ID_TIPOPEDIDO bigint,P_ID_AREAORIGEN bigint,P_ID_AREADESTINO bigint,P_ID_GASTO bigint,P_FECHA_ENTREGA text,P_MOTIVO text,P_ESTADO text,P_ID_PEDIDO OUT bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) AS $body$
DECLARE

        L_ID_TIPOPEDIDO bigint;
        L_ID_AREADESTINO bigint;
        L_ID_GASTO bigint;

BEGIN
            IF coalesce(P_ID_TIPOPEDIDO::text, '') = '' OR P_ID_TIPOPEDIDO = 0 THEN
                L_ID_TIPOPEDIDO := NULL;
            ELSE
                L_ID_TIPOPEDIDO := P_ID_TIPOPEDIDO;
            END IF;
            IF coalesce(P_ID_AREADESTINO::text, '') = '' OR P_ID_AREADESTINO = 0 THEN
               L_ID_AREADESTINO := NULL;
            ELSE
                L_ID_AREADESTINO := P_ID_AREADESTINO;
            END IF;
            IF coalesce(P_ID_GASTO::text, '') = '' OR P_ID_GASTO = 0 THEN
                L_ID_GASTO := NULL;
            ELSE
                L_ID_GASTO := P_ID_GASTO;
            END IF;

            INSERT INTO PEDIDO_REGISTRO(ID_ENTIDAD,ID_DEPTO,ID_ANHO,ID_MES,ID_PERSONA,ID_TIPOPEDIDO,ID_AREAORIGEN,ID_AREADESTINO,ID_GASTO,MOTIVO,FECHA,FECHA_PEDIDO,FECHA_ENTREGA,ESTADO)
            VALUES (P_ID_ENTIDAD,P_ID_DEPTO,P_ID_ANHO,P_ID_MES,P_ID_PERSONA,L_ID_TIPOPEDIDO,P_ID_AREAORIGEN,L_ID_AREADESTINO,L_ID_GASTO,P_MOTIVO,clock_timestamp(),clock_timestamp(),P_FECHA_ENTREGA,P_ESTADO) RETURNING ID_PEDIDO INTO P_ID_PEDIDO;
            P_ERROR := 0;
            P_MSGERROR := '0';

              
        EXCEPTION
            WHEN OTHERS THEN
                P_ERROR := 1;
                P_MSGERROR := 'ERROR AL REGISTRAR EL PEDIDO'||SQLSTATE||' -ERROR- '||SQLERRM;

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_orders_sp_insert_pedido (P_ID_ENTIDAD bigint,P_ID_DEPTO text,P_ID_ANHO bigint,P_ID_MES bigint,P_ID_PERSONA bigint,P_ID_TIPOPEDIDO bigint,P_ID_AREAORIGEN bigint,P_ID_AREADESTINO bigint,P_ID_GASTO bigint,P_FECHA_ENTREGA text,P_MOTIVO text,P_ESTADO text,P_ID_PEDIDO OUT bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) FROM PUBLIC;
