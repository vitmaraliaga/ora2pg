-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_process,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_process_sp_proceso_paso_run (P_ID_REGISTRO bigint, P_ID_PASO bigint, P_ID_PERSONA bigint,P_DETALLE text, P_NUMERO bigint,P_IP text,P_CLAVE text, P_VALOR text) AS $body$
DECLARE

        L_ID_DETALLE integer;
        L_ID_PARAMETRO integer;

BEGIN   
        --SELECT NVL(MAX(ID_DETALLE),0)+1 INTO L_ID_DETALLE FROM PROCESS_PASO_RUN;
        
        INSERT INTO PROCESS_PASO_RUN(
                                --ID_DETALLE,
                                ID_REGISTRO,ID_PASO,ID_PERSONA,FECHA,DETALLE,NUMERO,REVISADO,IP,ESTADO)
                                VALUES (
                               --L_ID_DETALLE,
                               P_ID_REGISTRO,P_ID_PASO,P_ID_PERSONA,clock_timestamp(),P_DETALLE,P_NUMERO,'0',P_IP,'1') returning ID_REGISTRO INTO L_ID_DETALLE;

        SELECT coalesce(MAX(ID_PARAMETRO),0)+1 INTO STRICT L_ID_PARAMETRO FROM PROCESS_PARAMETRO;
        INSERT INTO PROCESS_PARAMETRO(ID_PARAMETRO,ID_DETALLE,CLAVE,VALOR)VALUES (L_ID_PARAMETRO,L_ID_DETALLE,P_CLAVE,P_VALOR);

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_process_sp_proceso_paso_run (P_ID_REGISTRO bigint, P_ID_PASO bigint, P_ID_PERSONA bigint,P_DETALLE text, P_NUMERO bigint,P_IP text,P_CLAVE text, P_VALOR text) FROM PUBLIC;
