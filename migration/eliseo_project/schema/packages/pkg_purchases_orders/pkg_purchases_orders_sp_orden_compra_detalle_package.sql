-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_purchases_orders,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_purchases_orders_sp_orden_compra_detalle ( P_ID_ORDEN integer, P_ID_ALMACEN integer, P_ID_ARTICULO integer, P_DETALLE text, P_CANTIDAD bigint, P_PRECIO bigint, P_TOTAL bigint, P_ERROR OUT bigint, P_MSGERROR OUT text ) AS $body$
DECLARE


        L_ID_PEDIDO bigint;
        L_ID_ARTICULO bigint;
        L_ID_ALMACEN bigint;
        L_MSN varchar(200);
        L_ESTADO varchar(1):='0';
        L_NUMERO varchar(10);

BEGIN
            IF P_ID_ARTICULO = 0 THEN
                L_ID_ARTICULO := NULL;
            ELSE
                L_ID_ARTICULO := P_ID_ARTICULO;
            END IF;
            IF P_ID_ALMACEN = 0 THEN
                L_ID_ALMACEN := NULL;
            ELSE
                L_ID_ALMACEN := P_ID_ALMACEN;
            END IF;
            INSERT INTO COMPRA_ORDEN_DETALLE(
                ID_ORDEN,
                ID_ALMACEN,
                ID_ARTICULO,
                DETALLE,
                CANTIDAD,
                PRECIO,
                TOTAL
            )VALUES (
                P_ID_ORDEN,--PEDIDO
                L_ID_ALMACEN,--LOGISTICA
                L_ID_ARTICULO,
                P_DETALLE,--DESCRIPCION DEL ARTICULO
                P_CANTIDAD,
                P_PRECIO,
                P_TOTAL
            );
                P_ERROR :=0;
                L_MSN := 'OK';
                P_MSGERROR := L_MSN;
        EXCEPTION
            WHEN OTHERS THEN
            P_MSGERROR := 'ERROR AL REGISTRAR EL DETALLE'||SQLSTATE||' -ERROR- '||SQLERRM;
            P_ERROR :=1;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_purchases_orders_sp_orden_compra_detalle ( P_ID_ORDEN integer, P_ID_ALMACEN integer, P_ID_ARTICULO integer, P_DETALLE text, P_CANTIDAD bigint, P_PRECIO bigint, P_TOTAL bigint, P_ERROR OUT bigint, P_MSGERROR OUT text ) FROM PUBLIC;
