-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,utils,public;




CREATE OR REPLACE FUNCTION eliseo.utils_to_base (p_dec bigint, p_base bigint) RETURNS varchar AS $body$
DECLARE

    v_str varchar(255);
    v_num bigint;
    v_hex varchar(16) := '0123456789ABCDEF';

BEGIN
    v_num := p_dec;

    IF coalesce(p_dec::text, '') = '' OR coalesce(p_base::text, '') = '' THEN
      RETURN NULL;
    END IF;

    IF date_trunc('day', p_dec) <> p_dec OR p_dec < 0 THEN
        RAISE internal_error;
    END IF;

    LOOP
      v_str := SUBSTR(v_hex, MOD(v_num, p_base) + 1, 1) || v_str;
      v_num := date_trunc('day', v_num / p_base);

      EXIT WHEN v_num = 0;
    END LOOP;

    RETURN v_str;
EXCEPTION
    WHEN OTHERS THEN
      RAISE EXCEPTION '%', DBMS_UTILITY.FORMAT_ERROR_STACK USING ERRCODE = '45000';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION eliseo.utils_to_base (p_dec bigint, p_base bigint) FROM PUBLIC;
