-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_usuario_rol (id_rol, rol, id_persona, usuario, nombre, num_documento, id_usuario_reg, registrador) AS SELECT lr.id_rol, lr.nombre AS rol,
u.id AS id_persona,
u.email AS usuario,
pe.nombre || ' ' || pe.paterno ||' ' || pe.materno AS nombre,
pn.num_documento,
pe2.id_persona AS id_usuario_reg,
pe2.nombre || ' ' || pe2.paterno ||' ' || pe2.materno AS registrador

FROM eliseo.USERS u 
INNER JOIN eliseo.LAMB_USUARIO_ROL lur ON lur.id_persona = u.ID 
INNER JOIN eliseo.lamb_rol lr ON lr.id_rol=lur.id_rol
INNER JOIN moises.persona pe ON pe.ID_PERSONA =u.id 
INNER JOIN moises.persona pe2 ON pe2.id_persona = lur.id_user
LEFT JOIN moises.PERSONA_NATURAL pn ON pn.ID_PERSONA =pe.id_persona;

