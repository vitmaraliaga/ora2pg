-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_activo (id_entidad, id_activo, id_depto, id_tipoplan, id_cuentaaasi, id_restriccion, id_fondo, id_tipoactivoestado, nombre, cod_activo, categoria, marca, modelo, serie, seccion, fec_registro, fec_compra, fec_primeruso, tas_depreciacion, tas_especial, cos_valor, cos_dolar, cos_tipocambio, fec_movimiento) AS SELECT
	CONTA_Activo.ID_ENTIDAD,CONTA_Activo.ID_ACTIVO,CONTA_Activo.ID_DEPTO,CONTA_Activo.ID_TIPOPLAN,CONTA_Activo.ID_CUENTAAASI,CONTA_Activo.ID_RESTRICCION,CONTA_Activo.ID_FONDO,CONTA_Activo.ID_TIPOACTIVOESTADO,CONTA_Activo.NOMBRE,CONTA_Activo.COD_ACTIVO,CONTA_Activo.CATEGORIA,CONTA_Activo.MARCA,CONTA_Activo.MODELO,CONTA_Activo.SERIE,CONTA_Activo.SECCION,CONTA_Activo.FEC_REGISTRO,CONTA_Activo.FEC_COMPRA,CONTA_Activo.FEC_PRIMERUSO,CONTA_Activo.TAS_DEPRECIACION,CONTA_Activo.TAS_ESPECIAL,CONTA_Activo.COS_VALOR,CONTA_Activo.COS_DOLAR,CONTA_Activo.COS_TIPOCAMBIO,
	Bajas.FEC_MOVIMIENTO
FROM
	CONTA_Activo
LEFT JOIN(
		SELECT
			DISTINCT ID_ENTIDAD,
			ID_ACTIVO,
			FEC_MOVIMIENTO
		FROM Conta_Activo_Movimiento
		WHERE ID_TIPOACTIVOMOVIMIENTO IN (5,6,7,8,10,11,12,13,14,15,16,17,18,19,20)
	) Bajas ON
	CONTA_Activo.ID_ENTIDAD = Bajas.ID_ENTIDAD
	AND CONTA_Activo.ID_ACTIVO = Bajas.ID_ACTIVO;

