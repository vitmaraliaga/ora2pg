-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW x_vw_sales_detail_saldo_col_2 (id_entidad, id_depto, id_anho, id_venta, id_articulo, id_cliente, id_sucursal, serie, numero, importe, importe_me, debe, haber) AS SELECT 
	ID_ENTIDAD,ID_DEPTO,ID_ANHO,ID_VENTA, ID_ARTICULO, ID_CLIENTE,ID_SUCURSAL,SERIE,NUMERO,
    SUM(IMPORTE) IMPORTE,
    SUM(IMPORTE_ME) IMPORTE_ME,
    SUM(CASE WHEN IMPORTE > 0 THEN IMPORTE ELSE 0 END) DEBE,
    SUM(CASE WHEN IMPORTE > 0 THEN 0 ELSE IMPORTE END) HABER
    --,SUM(TOTAL) TOTAL
    --,SUM(TOTAL_ME) TOTAL_ME
	FROM VW_SALES_DETAIL_MOV_COL 
	WHERE  NOT ID_TIPOTRANSACCION =  164
	GROUP BY ID_ENTIDAD,ID_DEPTO,ID_ANHO,ID_VENTA,ID_ARTICULO,ID_CLIENTE,ID_SUCURSAL,SERIE,NUMERO;

