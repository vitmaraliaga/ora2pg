-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

FUNCTION        detalles_contrato(s_id_contrato in varchar2) RETURN varchar2 IS
	p_detalles  varchar2(512);
	CURSOR c_detalle_matricula IS
		 SELECT '; '||act.descripcion||' ('||TRIM(TO_CHAR(act.importe*decode(act.dc,'D',1,-1),'999,990.99'))||')' descripcion
     FROM eliseo.mat_alumno_contrato_det act
     WHERE act.ID_CRITERIO_SEMESTRE in (select  csa.ID_CRITERIO_SEMESTRE from eliseo.mat_criterio_semestre_asiento  csa)
       and act.id_alumno_contrato = s_id_contrato
    order by act.id_alumno_contrato_det;

BEGIN
    p_detalles := '';

    for detalle in  c_detalle_matricula  LOOP
        p_detalles := p_detalles||detalle.descripcion;
    end LOOP;  

    p_detalles := substr(p_detalles,2);



  RETURN( p_detalles );

END;

