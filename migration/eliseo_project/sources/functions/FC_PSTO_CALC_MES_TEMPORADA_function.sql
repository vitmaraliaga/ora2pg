-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

function FC_PSTO_CALC_MES_TEMPORADA(P_ID_TEMPORADA varchar2) RETURN NUMBER
IS
l_dato1 number:=0;
l_dato2 number:=0;
l_dato number:=0;
l_contar number:=0;
l_inicio number:=0;
l_fin number:=0;
l_inicio1 number:=0;
l_fin1 number:=0;
BEGIN

  select count(*) into  l_contar from PSTO_PLLA_TEMPORADA where id_temporada=P_ID_TEMPORADA;
  if l_contar =0 then
    l_dato:=0;
  else
    select INICIO,FIN,INICIO1,FIN1 
    into l_inicio,l_fin,l_inicio1,l_fin1
    from PSTO_PLLA_TEMPORADA where id_temporada=P_ID_TEMPORADA;
    
    if l_inicio>0 and l_fin>0 then
      l_dato1:=(l_fin-l_inicio)+1;
    end if;
    if l_inicio1>0 and l_fin1>0 then
      l_dato2:=(l_fin1-l_inicio1)+1;
    end if;
    l_dato:=l_dato1+l_dato2;
	end if;
  
  if l_dato>12 then
    l_dato:=12;
  end if;
  
  if l_dato<0 then
    l_dato:=0;
  end if;
  
	RETURN(l_dato);
END;

