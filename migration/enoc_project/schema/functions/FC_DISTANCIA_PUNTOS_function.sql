-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION enoc.fc_distancia_puntos ( P_LATITUDE1 bigint, P_LONGITUDE1 bigint, P_LATITUDE2 bigint, P_LONGITUDE2 bigint ) RETURNS bigint AS $body$
DECLARE

ret bigint:=0;
earth_radius  bigint := 6371;
pi_approx     bigint := 3.1415927/180;
lat_delta     bigint := 0;
lon_delta     bigint := 0;
arc           bigint := 0;

BEGIN

  lat_delta:= (p_latitude2-p_latitude1)*pi_approx;
  lon_delta:= (p_longitude2-p_longitude1)*pi_approx;
  arc:= sin(lat_delta/2) * sin(lat_delta/2) +sin(lon_delta/2) * sin(lon_delta/2) * cos(p_latitude1*pi_approx) * cos(p_latitude2*pi_approx);

  ret:= earth_radius * 2 * atan2(sqrt(arc), sqrt(1-arc));

	RETURN(ret*1000);
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION enoc.fc_distancia_puntos ( P_LATITUDE1 bigint, P_LONGITUDE1 bigint, P_LATITUDE2 bigint, P_LONGITUDE2 bigint ) FROM PUBLIC;

