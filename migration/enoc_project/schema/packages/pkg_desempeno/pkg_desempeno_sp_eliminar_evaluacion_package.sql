-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = enoc,pkg_desempeno,public;




CREATE OR REPLACE PROCEDURE enoc.pkg_desempeno_sp_eliminar_evaluacion (P_ID_PARTICIPANTE_EVALUADOR bigint, P_ID_USER_REG bigint,P_ERROR OUT bigint, P_MSGERROR out text) AS $body$
DECLARE

        l_contar bigint;
        l_error bigint:=0;
        l_msgerror varchar(200):='';
        l_id_participante bigint;

BEGIN
       
        select id_participante into STRICT l_id_participante from ENOC.DES_PARTICIPANTE_EVALUADOR where ID_PARTICIPANTE_EVALUADOR=P_ID_PARTICIPANTE_EVALUADOR;

        DELETE FROM ENOC.DES_RESULTADO where ID_PARTICIPANTE_EVALUADOR=P_ID_PARTICIPANTE_EVALUADOR;

        UPDATE ENOC.DES_PARTICIPANTE_EVALUADOR SET
          FINALIZADO=0,
          COMENTARIO = NULL,
          id_user_mod=P_ID_USER_REG,
          fecha_mod=clock_timestamp()
        where ID_PARTICIPANTE_EVALUADOR=P_ID_PARTICIPANTE_EVALUADOR;
        
        ENOC.CALL pkg_desempeno_sp_generar_puntaje(l_id_participante,'P',P_ID_USER_REG,l_error, l_msgerror);

        P_ERROR:=l_error;
        P_MSGERROR:=l_msgerror;
       END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE enoc.pkg_desempeno_sp_eliminar_evaluacion (P_ID_PARTICIPANTE_EVALUADOR bigint, P_ID_USER_REG bigint,P_ERROR OUT bigint, P_MSGERROR out text) FROM PUBLIC;
