-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = enoc,pkg_contract,public;




CREATE OR REPLACE PROCEDURE enoc.pkg_contract_sp_paisresidencia (P_ID_CONTRATO bigint, P_PARAMETRO text,P_PARAMETRO_RET OUT text, P_ERROR OUT bigint,P_MSGERROR out text) AS $body$
DECLARE

        l_contar bigint;
        l_error bigint:=0;
        l_msgerror varchar(200):='';
        l_parametro text:='';
        l_id_persona bigint;
        l_id_tipopais bigint;

      
BEGIN
      
        SELECT id_persona into STRICT l_id_persona from plla_contrato where id_contrato=P_ID_CONTRATO;

        SELECT count(*) into STRICT l_contar FROM MOISES.PERSONA_DIRECCION X WHERE X.ID_PERSONA=l_id_persona AND X.ID_TIPODIRECCION=4 AND X.ES_ACTIVO=1 and (X.id_TIPOPAIS IS NOT NULL AND X.id_TIPOPAIS::text <> '')   LIMIT 1;
        if l_contar>0 then
            SELECT X.id_TIPOPAIS into STRICT  l_id_tipopais  FROM MOISES.PERSONA_DIRECCION X WHERE X.ID_PERSONA=l_id_persona AND X.ID_TIPODIRECCION=4 AND X.ES_ACTIVO=1 and (X.id_TIPOPAIS IS NOT NULL AND X.id_TIPOPAIS::text <> '')   LIMIT 1;

            select gentilicio into STRICT l_parametro from MOISES.tipo_pais where id_TIPOPAIS=l_id_tipopais;
         end if;
        P_ERROR:=l_error;
        P_MSGERROR:=l_msgerror;
        P_PARAMETRO_RET:=l_parametro;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE enoc.pkg_contract_sp_paisresidencia (P_ID_CONTRATO bigint, P_PARAMETRO text,P_PARAMETRO_RET OUT text, P_ERROR OUT bigint,P_MSGERROR out text) FROM PUBLIC;
