-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = enoc,pkg_planilla,public;




CREATE OR REPLACE PROCEDURE enoc.pkg_planilla_sp_insmod_planilla_trab_det ( P_ID_PLANILLA_TRAB text, P_ID_CONCEPTO_PLANILLA bigint, P_IMPORTE bigint, P_NUM_DIAS bigint, P_NUM_HORAS bigint, P_IMPORTE_HORAS bigint, P_IMPORTE_DIAS bigint, P_IMPORTE_REF bigint, P_PJE_REF bigint, P_IMPORTE_BASE bigint ) AS $body$
DECLARE

    l_contar bigint:=0;
    l_id_planilla_trab_det varchar(50);

BEGIN
  
    l_id_planilla_trab_det:= P_ID_PLANILLA_TRAB||P_ID_CONCEPTO_PLANILLA::text;

    select count(1) into STRICT l_contar from PLLA_PLANILLA_TRAB_DET where ID_PLANILLA_TRAB=P_ID_PLANILLA_TRAB and ID_CONCEPTO_PLANILLA=P_ID_CONCEPTO_PLANILLA;

    if l_contar=0 then
    
      insert into PLLA_PLANILLA_TRAB_DET(
        ID_PLANILLA_TRAB_DET,
        ID_PLANILLA_TRAB,
        ID_CONCEPTO_PLANILLA,
        IMPORTE,
        NUM_DIAS,
        NUM_HORAS,
        IMPORTE_HORAS,
        IMPORTE_DIAS,
        IMPORTE_REF,
        PJE_REF,
        IMPORTE_BASE
      )values (
        l_id_planilla_trab_det,
        P_ID_PLANILLA_TRAB,
        P_ID_CONCEPTO_PLANILLA,
        P_IMPORTE,
        P_NUM_DIAS,
        P_NUM_HORAS,
        P_IMPORTE_HORAS,
        P_IMPORTE_DIAS,
        P_IMPORTE_REF,
        P_PJE_REF,
        P_IMPORTE_BASE
      );
    ELSE
      UPDATE PLLA_PLANILLA_TRAB_DET SET
        IMPORTE=P_IMPORTE,
        NUM_DIAS=P_NUM_DIAS,
        NUM_HORAS=P_IMPORTE,
        IMPORTE_HORAS=P_NUM_HORAS,
        IMPORTE_DIAS=P_IMPORTE_DIAS,
        IMPORTE_REF=P_IMPORTE_REF,
        PJE_REF=P_PJE_REF,
        IMPORTE_BASE=P_IMPORTE_BASE
      WHERE ID_PLANILLA_TRAB_DET=l_id_planilla_trab_det;

    END IF;
  END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE enoc.pkg_planilla_sp_insmod_planilla_trab_det ( P_ID_PLANILLA_TRAB text, P_ID_CONCEPTO_PLANILLA bigint, P_IMPORTE bigint, P_NUM_DIAS bigint, P_NUM_HORAS bigint, P_IMPORTE_HORAS bigint, P_IMPORTE_DIAS bigint, P_IMPORTE_REF bigint, P_PJE_REF bigint, P_IMPORTE_BASE bigint ) FROM PUBLIC;
