-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_costoxhora_carga_sum_eje_re (id_anho, id_mes, id_sedearea, id_programa_estudio, id_persona, id_semestre, id_tipo_hora_pago, id_solic_req_candidato, dias, horas, hora_asin) AS select 
TO_NUMBER(TO_CHAR(a.FECHA,'YYYY')) AS ID_ANHO,
TO_NUMBER(TO_CHAR(a.FECHA,'MM')) AS ID_MES,
a.ID_SEDEAREA,
a.ID_PROGRAMA_ESTUDIO,
a.ID_PERSONA,
a.ID_SEMESTRE,
b.ID_TIPO_HORA_PAGO,
a.ID_SOLIC_REQ_CANDIDATO,
COUNT(distinct a.FECHA) AS DIAS,
SUM(a.HORAS) AS HORAS,
a.HORA_ASIN
FROM enoc.PLLA_COSTOXHORA_CARGA_REQ a, ENOC.PLLA_TIPO_HORA_PAGO_HORARIO b
where a.ID_TIPO_MODALIDAD_DOCENTE=b.ID_TIPO_MODALIDAD_DOCENTE
GROUP BY TO_CHAR(a.FECHA,'YYYY') ,
TO_CHAR(a.FECHA,'MM'),
a.ID_SEDEAREA,
a.ID_PROGRAMA_ESTUDIO,
b.ID_TIPO_HORA_PAGO,a.ID_PERSONA,a.ID_SOLIC_REQ_CANDIDATO,
a.ID_SEMESTRE,a.HORA_ASIN;

