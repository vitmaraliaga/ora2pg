-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_aviso_vacacion (id_periodo_vac_trab, id_periodo_vac, id_trabajador, periodo_ini, periodo_fin, periodo_ini_trab, periodo_fin_trab, total_dias, total_dias_efect, id_estado_vac_trab, comentario, dias_anho, id_estado_periodo_vac, anho_inicio, id_rol_vacacion, fecha_ini, fecha_fin, dias, dias_efect, condicion, id_estado_rol_vac, fecha_registra, id_user_reg, id_tipo_suspension, confirmacion_salida, fecha_confirmacion_salida, user_confirmacion_salida, confirmacion_retorno, fecha_confirmacion_retorno, user_confirmacion_retorno, motivo_repro, id_tipo_rol_vac, id_sol_vac_adel_det, salida_url, ndias, id_contrato, id_perfil_puesto, id_situacion_trabajador, id_condicion_laboral, fecha_ingreso, fecha_inicio, fecha_fin_previsto, fecha_fin_efectivo, id_tipo_contrato, id_sedearea, id_puesto, id_tipo_tiempo_trabajo, id_grupo_planilla, id_tipo_horario, id_persona, id_situacion_educativo, id_tipodocumento, num_documento, sexo, fec_nacimiento, telefono, celular, correo, correo_inst, firma, apellidonombre, nombreapellido, apellidos, id_entidad, id_perfil_puesto_jefe, tipo_asignar, id_perfil_puesto_area, id_tipo_jefe) AS select
a.ID_PERIODO_VAC_TRAB,
a.ID_PERIODO_VAC,
a.ID_TRABAJADOR,
a.PERIODO_INI,
a.PERIODO_FIN,
a.PERIODO_INI_TRAB,
a.PERIODO_FIN_TRAB,
a.TOTAL_DIAS,
a.TOTAL_DIAS_EFECT,
a.ID_ESTADO_VAC_TRAB,
a.COMENTARIO,
a.DIAS_ANHO,
a.ID_ESTADO_PERIODO_VAC,
a.ANHO_INICIO,
a.ID_ROL_VACACION,
a.FECHA_INI,
a.FECHA_FIN,
a.DIAS,
a.DIAS_EFECT,
a.CONDICION,
a.ID_ESTADO_ROL_VAC,
a.FECHA_REGISTRA,
a.ID_USER_REG,
a.ID_TIPO_SUSPENSION,
a.CONFIRMACION_SALIDA,
a.FECHA_CONFIRMACION_SALIDA,
a.USER_CONFIRMACION_SALIDA,
a.CONFIRMACION_RETORNO,
a.FECHA_CONFIRMACION_RETORNO,
a.USER_CONFIRMACION_RETORNO,
a.MOTIVO_REPRO,
a.ID_TIPO_ROL_VAC,
a.ID_SOL_VAC_ADEL_DET,
a.SALIDA_URL,
((trunc(a.fecha_ini) - trunc(sysdate))+1) as ndias,
t.ID_CONTRATO,
t.ID_PERFIL_PUESTO,
t.ID_SITUACION_TRABAJADOR,
t.ID_CONDICION_LABORAL,
t.FECHA_INGRESO,
t.FECHA_INICIO,
t.FECHA_FIN_PREVISTO,
t.FECHA_FIN_EFECTIVO,
t.ID_TIPO_CONTRATO,
t.ID_SEDEAREA,
t.ID_PUESTO,
t.ID_TIPO_TIEMPO_TRABAJO,
t.ID_GRUPO_PLANILLA,
t.ID_TIPO_HORARIO,
t.ID_PERSONA,
t.ID_SITUACION_EDUCATIVO,
t.ID_TIPODOCUMENTO,
t.NUM_DOCUMENTO,
t.SEXO,
t.FEC_NACIMIENTO,
t.TELEFONO,
t.CELULAR,
t.CORREO,
t.CORREO_INST,
t.FIRMA,
t.APELLIDONOMBRE,
t.NOMBREAPELLIDO,
t.APELLIDOS,
t.id_entidad,
pp.ID_PERFIL_PUESTO_JEFE,
pp.TIPO_ASIGNAR,
pp.ID_PERFIL_PUESTO_AREA,
pp.ID_TIPO_JEFE
FROM ENOC.VW_ROL_VACACIONAL a,
enoc.vw_trabajador t,
enoc.plla_perfil_puesto pp
where t.id_trabajador=a.id_trabajador
and t.id_perfil_puesto=pp.id_perfil_puesto
and a.condicion='P'
and a.id_estado_vac_trab='02'
union
select
a.ID_PERIODO_VAC_TRAB,
a.ID_PERIODO_VAC,
a.ID_TRABAJADOR,
a.PERIODO_INI,
a.PERIODO_FIN,
a.PERIODO_INI_TRAB,
a.PERIODO_FIN_TRAB,
a.TOTAL_DIAS,
a.TOTAL_DIAS_EFECT,
a.ID_ESTADO_VAC_TRAB,
a.COMENTARIO,
a.DIAS_ANHO,
a.ID_ESTADO_PERIODO_VAC,
a.ANHO_INICIO,
a.ID_ROL_VACACION,
a.FECHA_INI,
a.FECHA_FIN,
a.DIAS,
a.DIAS_EFECT,
a.CONDICION,
a.ID_ESTADO_ROL_VAC,
a.FECHA_REGISTRA,
a.ID_USER_REG,
a.ID_TIPO_SUSPENSION,
a.CONFIRMACION_SALIDA,
a.FECHA_CONFIRMACION_SALIDA,
a.USER_CONFIRMACION_SALIDA,
a.CONFIRMACION_RETORNO,
a.FECHA_CONFIRMACION_RETORNO,
a.USER_CONFIRMACION_RETORNO,
a.MOTIVO_REPRO,
a.ID_TIPO_ROL_VAC,
a.ID_SOL_VAC_ADEL_DET,
a.SALIDA_URL,
((trunc(a.fecha_ini) - trunc(sysdate))+1) as ndias,
t.ID_CONTRATO,
t.ID_PERFIL_PUESTO,
t.ID_SITUACION_TRABAJADOR,
t.ID_CONDICION_LABORAL,
t.FECHA_INGRESO,
t.FECHA_INICIO,
t.FECHA_FIN_PREVISTO,
t.FECHA_FIN_EFECTIVO,
t.ID_TIPO_CONTRATO,
t.ID_SEDEAREA,
t.ID_PUESTO,
t.ID_TIPO_TIEMPO_TRABAJO,
t.ID_GRUPO_PLANILLA,
t.ID_TIPO_HORARIO,
t.ID_PERSONA,
t.ID_SITUACION_EDUCATIVO,
t.ID_TIPODOCUMENTO,
t.NUM_DOCUMENTO,
t.SEXO,
t.FEC_NACIMIENTO,
t.TELEFONO,
t.CELULAR,
t.CORREO,
t.CORREO_INST,
t.FIRMA,
t.APELLIDONOMBRE,
t.NOMBREAPELLIDO,
t.APELLIDOS,
t.id_entidad,
pp.ID_PERFIL_PUESTO_JEFE,
pp.TIPO_ASIGNAR,
pp.ID_PERFIL_PUESTO_AREA,
pp.ID_TIPO_JEFE
from ENOC.VW_ROL_VACACIONAL a,
enoc.vw_trabajador t,
enoc.plla_perfil_puesto pp
where t.id_trabajador=a.id_trabajador
and t.id_perfil_puesto=pp.id_perfil_puesto
and a.condicion='P'
and a.id_tipo_rol_vac='A';

