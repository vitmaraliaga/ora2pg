-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_costoxhora_carga_sum_req (id_anho, id_mes, id_sedearea, id_programa_estudio, id_persona, id_semestre, id_tipo_modalidad_docente, id_solic_req_candidato, dias, horas) AS select
(TO_CHAR(FECHA,'YYYY'))::numeric  AS ID_ANHO,
(TO_CHAR(FECHA,'MM'))::numeric  AS ID_MES,
ID_SEDEAREA,
ID_PROGRAMA_ESTUDIO,
ID_PERSONA,
ID_SEMESTRE,
ID_TIPO_MODALIDAD_DOCENTE,
ID_SOLIC_REQ_CANDIDATO,
COUNT(distinct FECHA) AS DIAS,
SUM(HORAS) AS HORAS
FROM enoc.PLLA_COSTOXHORA_CARGA_REQ
GROUP BY TO_CHAR(FECHA,'YYYY') ,
TO_CHAR(FECHA,'MM'),
ID_SEDEAREA,
ID_PROGRAMA_ESTUDIO,
ID_TIPO_MODALIDAD_DOCENTE,ID_PERSONA,ID_SOLIC_REQ_CANDIDATO,
ID_SEMESTRE;

