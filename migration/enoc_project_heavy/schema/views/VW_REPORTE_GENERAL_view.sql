-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_reporte_general (id_trabajador, id_persona, nombre, paterno, materno, puesto, area, id_depto, ccosto, deptopadre, estado_civil, situacion_educativo, tipo_religion, pais, siglas, rigen_pensionaria, situacion_trabajador, tipo_control_personal, condicion_laboral, tipo_contrato, tipo_tiempo_trabajo, tipo_pago, fmr, sueldo, id_perfil_puesto, id_sedearea, id_depto_padre, id_situacion_trabajador, id_tipoestadocivil, id_situacion_educativo, id_tiporeligion, id_tipopais, id_tipodocumento, id_regimen_pensionaria, id_tipo_control_personal, id_condicion_laboral, id_tipo_contrato, id_tipo_tiempo_trabajo, id_remuneracion, id_escala_salarial, puntminimo, puntmaximo) AS select
a.id_trabajador,
a.id_persona,
a.nombre,
a.paterno,
a.materno,
b.puesto,
sa.nombre as area,
sa.id_depto,
sa.ccosto,
ed.nombre as deptopadre,
te.nombre as estado_civil,
se.nombre as situacion_educativo,
tr.nombre as tipo_religion,
tp.nombre as pais,
td.siglas,
rp.nombre as rigen_pensionaria,
st.nombre as situacion_trabajador,
tc.nombre as TIPO_CONTROL_PERSONAL,
cl.nombre as condicion_laboral,
tco.nombre as tipo_contrato,
ttt.nombre as TIPO_TIEMPO_TRABAJO,
rem.tipo_pago,
rem.fmr,
rem.sueldo,
a.id_perfil_puesto,
a.id_sedearea,
sa.id_depto_padre,
a.id_situacion_trabajador,
a.ID_TIPOESTADOCIVIL,
a.id_situacion_educativo,
a.id_tiporeligion,
a.id_tipopais,
a.id_tipodocumento,
a.id_regimen_pensionaria,
a.id_tipo_control_personal,
a.id_condicion_laboral,
a.id_tipo_contrato,
a.id_TIPO_TIEMPO_TRABAJO,
rem.id_remuneracion,
rem.ID_ESCALA_SALARIAL,
esa.PUNTMINIMO, 
esa.PUNTMAXIMO
FROM ENOC.vw_trabajador a 
inner join enoc.vw_perfil_puesto b on 
a.id_perfil_puesto=b.id_perfil_puesto
inner join eliseo.vw_sede_area sa  
on a.id_sedearea=sa.id_sedearea
inner join eliseo.conta_entidad_depto ed on
sa.id_entidad=ed.id_entidad
and sa.id_depto_padre=ed.id_depto
inner join moises.situacion_trabajador st
on st.id_situacion_trabajador=a.id_situacion_trabajador
left join moises.TIPO_ESTADO_CIVIL te
on te.ID_TIPOESTADOCIVIL=a.ID_TIPOESTADOCIVIL
left join moises.SITUACION_educativa se
on se.id_situacion_educativo= a.id_situacion_educativo
left join moises.tipo_religion tr
on tr.id_tiporeligion=a.id_tiporeligion
left join moises.tipo_pais tp
on tp.id_tipopais=a.id_tipopais
left join moises.tipo_documento td
on td.id_tipodocumento=a.id_tipodocumento
left join enoc.plla_regimen_pensionaria rp
on rp.id_regimen_pensionaria=a.id_regimen_pensionaria
left join moises.TIPO_CONTROL_PERSONAL tc
on tc.id_tipo_control_personal=a.id_tipo_control_personal
left join moises.condicion_laboral cl
on cl.id_condicion_laboral=a.id_condicion_laboral
left join enoc.plla_tipo_contrato tco
on tco.id_tipo_contrato=a.id_tipo_contrato
left join moises.TIPO_TIEMPO_TRABAJO ttt
on ttt.id_TIPO_TIEMPO_TRABAJO = a.id_TIPO_TIEMPO_TRABAJO
left join enoc.plla_remuneracion rem
on rem.id_trabajador=a.id_trabajador
and rem.vigencia=1
left join enoc.plla_ESCALA_SALARIAL esa
on esa.ID_ESCALA_SALARIAL=rem.ID_ESCALA_SALARIAL
and esa.ID_ANHO=(to_char(statement_timestamp(),'YYYY'))::numeric  
where a.id_entidad=7124
--and a.id_depto
and a.sexo=1
and b.id_tipo_jefe=1;

