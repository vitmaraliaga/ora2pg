-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = enoc,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_des_resultado_modelo_sum (id_participante, id_modelo_evaluacion, id_desempeno_mod_eval, puntaje, porcentaje, id_desempeno, id_perfil_puesto, puntos) AS select
A.ID_PARTICIPANTE,
A.id_modelo_evaluacion,
A.ID_DESEMPENO_MOD_EVAL,
COALESCE(SUM(A.PUNTOS),0) AS PUNTAJE,
M.porcentaje,
A.ID_DESEMPENO,
A.id_perfil_puesto,
ROUND(COALESCE(SUM(COALESCE(A.PUNTOS,0)),0)*(M.porcentaje/100),2) AS PUNTOS
FROM ENOC.VW_DES_RESULTADO_MODELO_EVAL A,ENOC.DES_DESEMPENO_MOD_EVAL M 
WHERE A.ID_DESEMPENO_MOD_EVAL=M.ID_DESEMPENO_MOD_EVAL
GROUP BY A.ID_PARTICIPANTE,
A.id_modelo_evaluacion,
A.ID_DESEMPENO_MOD_EVAL,
M.porcentaje,
A.ID_DESEMPENO,
A.id_perfil_puesto;

