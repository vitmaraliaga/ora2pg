-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.day_from_key ( P_VALUE text) RETURNS varchar AS $body$
DECLARE

    r varchar(100) := '';

BEGIN
    IF (P_VALUE IS NOT NULL AND P_VALUE::text <> '')
    THEN

        SELECT (string_agg(CD.NOMBRE, ', ' order by CD.NOMBRE))
        INTO STRICT r
        FROM ELISEO.CONTA_DIA CD
        WHERE ID_DIA IN (WITH RECURSIVE cte AS (
SELECT (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) AS parts

                         (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) IS NOT NULL  UNION ALL
SELECT (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) AS parts
                         
                         (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) IS NOT NULL JOIN cte c ON ()

) SELECT * FROM cte);

    END IF;

    RETURN r;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.day_from_key ( P_VALUE text) FROM PUBLIC;

