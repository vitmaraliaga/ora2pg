-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.fc_convert_key_to_name_rule ( P_VALUE text) RETURNS varchar AS $body$
DECLARE

    r varchar(100) := '';

BEGIN
    IF (P_VALUE IS NOT NULL AND P_VALUE::text <> '')
    THEN

        SELECT (string_agg(RET.DAY, ', ' order by NULL))
        INTO STRICT r
        FROM (SELECT (CASE
                          WHEN key = 1 THEN 'Lunes'
                          WHEN key = 2 THEN 'Martes'
                          WHEN key = 3 THEN 'Miércoles'
                          WHEN key = 4 THEN 'Jueves'
                          WHEN key = 5 THEN 'Viernes'
                          WHEN key = 6 THEN 'Sábado'
                          WHEN key = 7 THEN 'Domingo'
                          ELSE ''
            END) AS DAY
              FROM (WITH RECURSIVE cte AS (
SELECT (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) AS key

                    (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) IS NOT NULL  UNION ALL
SELECT (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) AS key
                    
                    (SELECT array_to_string(a, '') FROM regexp_matches(P_VALUE, '[^,]+', 'g') AS foo(a) LIMIT 1 OFFSET (level - 1) ) IS NOT NULL JOIN cte c ON ()

) SELECT * FROM cte) ) RET;
    END IF;

    RETURN r;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.fc_convert_key_to_name_rule ( P_VALUE text) FROM PUBLIC;

