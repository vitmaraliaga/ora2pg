-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.horario (HORARIO text,NUM_DIA text) RETURNS varchar AS $body$
DECLARE


NUM bigint;
INI bigint;
NVAL bigint;
VAL varchar(1000);
T_HORARIO varchar(1000);
T_TURNO varchar(1000);
T_PERIODO varchar(1000);
P_HORA_INICIO varchar(1000);
P_HORA_FIN varchar(1000);
RES varchar(1000);


BEGIN

  SELECT ''||CEIL((LENGTH(REPLACE(HORARIO,'-','')))/3) INTO STRICT NUM;
  
  INI:=1;
  NVAL:=1;

  WHILE INI <= NUM
  LOOP
  
    SELECT SUBSTR(HORARIO,NVAL,1) INTO STRICT VAL;

    IF (VAL=NUM_DIA) THEN
      T_HORARIO:=SUBSTR(HORARIO,NVAL+1,2);
      INI:=5000;
    END IF;

    INI:=INI+1;
    NVAL:=NVAL+4;

  END LOOP;

  RES:=T_HORARIO;
  RETURN RES;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.horario (HORARIO text,NUM_DIA text) FROM PUBLIC;

