-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.ft_meta_sem_prog ( p_id_semestre integer, p_id_programa_estudio integer, p_tipo text) RETURNS bigint AS $body$
DECLARE

	p_meta	  bigint;
	p_meta_credito	  bigint;
	p_res	  bigint;
		

BEGIN

  select (coalesce(Cantidad_Alumnos,0))::numeric  META,(coalesce(Cantidad_Creditos,0))::numeric  CREDITO_META into STRICT p_meta,p_meta_credito
  from eliseo.fin_metas fm inner join acad_semestre_programa asp on asp.id_semestre_programa=Fm.Id_Semestre_Programa
  inner join acad_semestre asm on asm.id_semestre=asp.id_semestre
  inner join vw_acad_programa_estudio a on a.Id_Programa_Estudio=Asp.Id_Programa_Estudio
  where Asp.Id_Semestre=p_id_semestre and Asp.Id_Programa_Estudio=p_id_programa_estudio;

  if (p_tipo='M') then
  
    p_res:=p_meta;

  else
  
    p_res:=p_meta_credito;

  end if;

  return p_res;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.ft_meta_sem_prog ( p_id_semestre integer, p_id_programa_estudio integer, p_tipo text) FROM PUBLIC;

