-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.ft_tipo_cargo_ant (p_codigo_personal text,p_semestre text,p_tipo text) RETURNS varchar AS $body$
DECLARE

  p_resultado varchar(500);

BEGIN

  Declare
    v_unidad_id varchar(500);
    v_condicion_laboral varchar(500);
    v_id_condicion_laboral varchar(500);
    v_categoria varchar(500);
    v_tiempo varchar(500);

  begin

    select ''||unidad_id,
    CASE WHEN condicion_laboral='00' THEN 'Ninguno' WHEN condicion_laboral='C1' THEN 'Contratado a Tiempo Completo' WHEN condicion_laboral='C2' THEN 'Contratado a Tiempo Completo' WHEN condicion_laboral='C3' THEN 'Contratado a Tiempo Completo' WHEN condicion_laboral='C4' THEN 'Contratado a Tiempo Completo' WHEN condicion_laboral='C' THEN 'Contratado a Tiempo parcial' WHEN condicion_laboral='E' THEN 'Empleado' WHEN condicion_laboral='M' THEN 'Misionero' END ,
    CASE WHEN condicion_laboral='00' THEN 'N' WHEN condicion_laboral='C1' THEN 'CTC' WHEN condicion_laboral='C2' THEN 'CTC' WHEN condicion_laboral='C3' THEN 'CTC' WHEN condicion_laboral='C4' THEN 'CTC' WHEN condicion_laboral='C' THEN 'C' WHEN condicion_laboral='E' THEN 'E' WHEN condicion_laboral='M' THEN 'M' END ,
    CASE WHEN categoria='PP' THEN 'Profesor  Principal' WHEN categoria='PA' THEN 'Profesor Asociado' WHEN categoria='PX' THEN 'Profesor Auxiliar' WHEN categoria='PS' THEN 'Profesor Asistente' WHEN categoria='JP' THEN 'Jefe Practica' WHEN categoria='AU' THEN 'Auxiliar' WHEN categoria='OT' THEN 'Otros' WHEN categoria='NA' THEN 'Ninguna' WHEN categoria='DC' THEN 'Docente Contratado' WHEN categoria='DX' THEN 'Docente Extraordinario' END  ,
    CASE WHEN tiempo='00' THEN 'Ninguno' WHEN tiempo='DE' THEN 'Dedicaci√≥n Exclusiva' WHEN tiempo='TC' THEN 'Tiempo Completo' WHEN tiempo='TP' THEN 'Tiempo Parcial' END  
    into STRICT v_unidad_id,v_condicion_laboral,v_id_condicion_laboral,v_categoria,v_tiempo
    from profesor_cargo@dbl_noe
    where semestre=p_semestre
    and codigo_personal=p_codigo_personal;

    if (p_tipo='CL') then
      p_resultado := v_condicion_laboral;
    end if;
    if (p_tipo='ID') then
      p_resultado := v_id_condicion_laboral;
    end if;
    if (p_tipo='C') then
      p_resultado := v_categoria;
    end if;
    if (p_tipo='T') then
      p_resultado := v_tiempo;
    end if;
    if (p_tipo='U') then
      p_resultado := v_unidad_id;
    end if;

  end;

  return p_resultado;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.ft_tipo_cargo_ant (p_codigo_personal text,p_semestre text,p_tipo text) FROM PUBLIC;

