-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION david.ft_cursos_solicitud (p_id_solicitud_mat_alum integer,p_id_tipo_solicitud integer) RETURNS varchar AS $body$
DECLARE


  resultado varchar(2000);


BEGIN

  SELECT cursos INTO STRICT resultado
  FROM (SELECT sma.id_solicitud_mat_alum,
        string_agg(vacp.CURSO  || ', Ciclo: ' || vacp.CICLO , '|' ORDER BY vacp.curso) AS cursos
      FROM 
      david.solicitud_mat_alum sma 
      INNER JOIN david.SOLICITUD_CURSO_MATRICULA scm ON sma.ID_SOLICITUD_MAT_ALUM =scm.ID_SOLICITUD_MAT_ALUM
      INNER JOIN david.VW_ACAD_CURSO_PLAN vacp ON vacp.ID_PLAN_CURSO =scm.ID_PLAN_CURSO
      WHERE sma.ID_TIPO_SOLICITUD_MATRICULA =p_id_tipo_solicitud
      AND  sma.ID_SOLICITUD_MAT_ALUM =p_id_solicitud_mat_alum
      GROUP BY sma.id_solicitud_mat_alum) alias1;

	RETURN resultado;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION david.ft_cursos_solicitud (p_id_solicitud_mat_alum integer,p_id_tipo_solicitud integer) FROM PUBLIC;

