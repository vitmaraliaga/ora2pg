-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = david,pk_procedure_doc,public;




CREATE OR REPLACE PROCEDURE david.pk_procedure_doc_sp_student_plan ( P_STUDENT_PLAN_ID bigint, P_CURSOR OUT REFCURSOR) AS $body$
BEGIN


        IF (P_STUDENT_PLAN_ID IS NOT NULL AND P_STUDENT_PLAN_ID::text <> '') THEN


            OPEN P_CURSOR FOR SELECT VAPP.NOM_FACULTAD      AS COLLEGE,
                                     VAPP.NOM_ESCUELA       AS SCHOOL,
                                     VAPP.SEDE              AS CAMPUS,
                                     APE.NOMBRE_CERTIFICADO AS CURRICULUM
                              FROM DAVID.VW_ALUMNO_PLAN_PROGRAMA VAPP
                                       INNER JOIN DAVID.ACAD_PROGRAMA_ESTUDIO APE
                                                  ON VAPP.ID_PROGRAMA_ESTUDIO = APE.ID_PROGRAMA_ESTUDIO
                              WHERE VAPP.ID_ALUMNO_PLAN = P_STUDENT_PLAN_ID;
        END IF;

    EXCEPTION
        WHEN OTHERS THEN
            RAISE NOTICE 'ERROR: %', SQLERRM;

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE david.pk_procedure_doc_sp_student_plan ( P_STUDENT_PLAN_ID bigint, P_CURSOR OUT REFCURSOR) FROM PUBLIC;
