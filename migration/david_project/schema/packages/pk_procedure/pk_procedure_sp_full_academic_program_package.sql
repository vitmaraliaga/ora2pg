-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = david,pk_procedure,public;




CREATE OR REPLACE PROCEDURE david.pk_procedure_sp_full_academic_program ( P_STUDENT_PLAN_ID bigint, P_CURSOR OUT REFCURSOR) AS $body$
DECLARE

        P_RET bigint := 0;
        P_STATUS
              smallint;
        P_MESSAGE
              varchar(200);

BEGIN

        SELECT DAVID.FT_GRADUADO_PLAN(AAP.ID_PERSONA, AAP.ID_PLAN_PROGRAMA)
        INTO STRICT P_RET
        FROM DAVID.ACAD_ALUMNO_PLAN AAP
        WHERE AAP.ID_ALUMNO_PLAN = P_STUDENT_PLAN_ID;


        IF
            P_RET = 0 THEN
            P_STATUS := 1;
            P_MESSAGE
                := 'Requisito aprobado.';
        ELSE
            P_STATUS := 0;
            P_MESSAGE
                := 'Requisito no aprobado.';
        END IF;

        OPEN P_CURSOR FOR
            SELECT P_STATUS as status, P_MESSAGE as message
;

    EXCEPTION
        WHEN no_data_found THEN
            RAISE NOTICE 'ERROR no_data_found';
        WHEN OTHERS THEN
            RAISE NOTICE 'ERROR: %', SQLERRM;

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE david.pk_procedure_sp_full_academic_program ( P_STUDENT_PLAN_ID bigint, P_CURSOR OUT REFCURSOR) FROM PUBLIC;
