-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_solicitud_curso_matricula (id_solicitud_mat_alum, id_solicitud_curso_matricula, id_persona, nombres, id_semestre, semestre, id_plan_programa, id_sede_alumno, id_programa_estudio_alumno, nombre_escuela_alumno, id_carga_curso, id_plan_curso, id_plan_curso_solicitado, id_curso_detalle, nombre_curso, credito, ht, hp, hnp, ciclo, grupo, id_sede_solicitado, id_programa_estudio_solicitado, nombre_escuela_solicitado, id_tipo_solicitud_matricula, tipo_solicitud_matricula, estado_solicitud, observacion, id_solicitud_curso_modo, tipo_solicitud_curso_modo, estado, codigo_solicitud, plan_origen, plan_destino) AS select sma.id_solicitud_mat_alum, scm.id_solicitud_curso_matricula,
sma.id_persona, apellido_persona(sma.id_persona) nombres,
sma.id_semestre, asm.semestre,
scm.id_plan_programa, ape.id_sede id_sede_alumno, 
app.id_programa_estudio id_programa_estudio_alumno, ape.nombre nombre_escuela_alumno,
scm.id_carga_curso, aca.id_plan_curso, scm.id_plan_curso id_plan_curso_solicitado, aca.id_curso_detalle,
aca.nombre_curso,aca.credito, aca.ht, aca.hp, aca.hnp, aca.ciclo, aca.grupo, 
aca.id_sede id_sede_solicitado, aca.id_programa_estudio id_programa_estudio_solicitado, aca.nom_escuela nombre_escuela_solicitado,
sma.id_tipo_solicitud_matricula, tsm.nombre tipo_solicitud_matricula,
sma.estado estado_solicitud, sma.observacion,
scm.id_solicitud_curso_modo, scmd.nombre tipo_solicitud_curso_modo,
scm.estado, sma.codigo AS codigo_solicitud,
vpp.NOMBRE_PLAN AS plan_origen, aca.nombre_plan AS plan_destino


FROM solicitud_mat_alum sma inner join solicitud_curso_matricula scm on scm.id_solicitud_mat_alum=sma.id_solicitud_mat_alum 
                            and sma.id_tipo_solicitud_matricula=2
inner join tipo_solicitud_matricula tsm on tsm.id_tipo_solicitud_matricula=sma.id_tipo_solicitud_matricula
inner join acad_semestre asm on asm.id_semestre=sma.id_semestre
inner join tipo_solicitud_curso_modo scmd on scmd.id_solicitud_curso_modo=scm.id_solicitud_curso_modo
inner join(select acc.id_carga_curso,apc.id_plan_curso,acd.id_curso_detalle,ac.nombre as nombre_curso,
            acd.credito, acd.ht, acd.hp, acd.hnp,apc.ciclo, acc.grupo,
            ape.id_sede, ape.id_programa_estudio, ape.nombre_escuela NOM_ESCUELA,
            vpp2.NOMBRE_PLAN
            
            from david.VW_ACAD_CARGA_ACADEMICA acc 
            INNER JOIN david.VW_PLAN_PROGRAMA vpp2 ON vpp2.ID_PLAN_PROGRAMA =acc.ID_PLAN_PROGRAMA 
            inner join acad_semestre_programa asp on asp.id_semestre_programa=acc.id_semestre_programa
            inner join vw_acad_programa_estudio ape on ape.id_programa_estudio=asp.id_programa_estudio
            inner join acad_carga_curso_det accd on accd.id_carga_curso=acc.id_carga_curso and accd.origen='O'
            inner join acad_plan_curso apc on apc.id_plan_curso=accd.id_plan_curso
            inner join acad_curso_detalle acd on acd.id_curso_detalle=apc.id_curso_detalle
            inner join acad_curso ac on ac.id_curso=acd.id_curso
            WHERE acc.ORIGEN ='O'
            ) aca on aca.id_carga_curso=scm.id_carga_curso
inner join acad_plan_programa app on app.id_plan_programa=scm.id_plan_programa
INNER JOIN david.VW_PLAN_PROGRAMA vpp ON vpp.ID_PLAN_PROGRAMA = app.ID_PLAN_PROGRAMA 
inner join vw_acad_programa_estudio ape on ape.id_programa_estudio=app.id_programa_estudio;

