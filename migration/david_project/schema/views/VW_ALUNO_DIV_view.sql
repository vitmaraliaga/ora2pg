-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_aluno_div (id_aluno, id_escola, ra, dtingresso, nome, sexo, dtaniversario, isadventista, ativo, tpdocumento, documento, anio) AS select distinct aac.Id_Persona id_aluno,ape.Id_Facultad id_Escola, Pa.Codigo RA,
CASE WHEN substr(vpp.Nombre_Plan,-1)='1' THEN '01/01/'  ELSE '01/06/' END ||substr(vpp.Nombre_Plan,0,4) dtIngresso,
Pa.Apellido_Nombre Nome,Pa.Sexo,Pa.Fec_Nacimiento dtAniversario,
CASE WHEN Pa.Religion='Adventista del Séptimo Día' THEN 'TRUE'  ELSE 'FALSE' END  isAdventista,
'TRUE' Ativo,Pa.Tipo_Doc tpDocumento,Pa.Num_Documento Documento, substr(aac.semestre,0,4) anio
FROM Vw_Acad_Alumno_Contrato aac inner join vw_acad_programa_estudio ape on ape.Id_Programa_Estudio=aac.Id_Programa_Estudio
inner join Vw_Persona_Alumno pa on Pa.Id_Persona=aac.Id_Persona
inner join Vw_Plan_Programa vpp on vpp.Id_Plan_Programa=aac.Id_Plan_Programa
where aac.estado='1' and aac.id_modo_contrato=1
and ape.id_nivel_ensenanza in (1,2) and ape.Id_Facultad not in (676,777,150,673,309,308) and ape.estado='1'
and ape.Id_Escuela not in (228,234,255,253,164,419,179,181,196,197,188,189,190,191,192,193,194,195,180,236,235,232,204,168,169,166,165,219)
and ape.Id_Tipo_Contrato in (1,2,3,4) and ape.Id_Modalidad_Estudio not in (3)
and ape.Nombre_Certificado not like 'Unidad de Posgrado%';

