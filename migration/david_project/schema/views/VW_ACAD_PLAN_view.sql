-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_acad_plan (id_plan, id_facultad, nom_facultad, cod_facultad, id_escuela, nom_escuela, cod_escuela, escuela_profesional, nombre_plan, fecha_inicio, fecha_fin, numero_cursos, nota_aprobatoria, id_semestre) AS select ap.id_plan,coalesce(CASE WHEN op.id_parent=8 THEN 8  ELSE null END , op.id_area) id_facultad, CASE WHEN CASE WHEN op.id_parent=8 THEN 8  ELSE null coalesce(END::text, '') = '' THEN op.nombre  ELSE opp.nombre END  nom_facultad,
CASE WHEN CASE WHEN op.id_parent=8 THEN 8  ELSE null coalesce(END::text, '') = '' THEN op.codigo  ELSE opp.codigo END  cod_facultad ,
oa.id_area id_escuela, oa.nombre nom_escuela, oa.codigo cod_escuela,coalesce(nep.Nombre,oa.Nombre) escuela_profesional,
ap.nombre nombre_plan, fecha_inicio, fecha_fin, numero_cursos, nota_aprobatoria, id_semestre
FROM acad_plan ap inner join eliseo.org_area oa on ap.id_area=oa.id_area
left join eliseo.org_escuela_profesional ep on Ep.Id_Area=oa.Id_Area
left join eliseo.org_area nep on nep.Id_Area=Ep.Id_Ep
left join  eliseo.org_area op on op.id_area=oa.id_parent
left join eliseo.org_area opp on opp.Id_Area=CASE WHEN op.id_parent=8 THEN 8  ELSE null END;

