-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_acuerdo_presentacion (nombre_escuela, nombre_facultad, estudiante, id_alumno_contrato, codigo, estado_contrato, id_acuerdo_contrato, estado_acuerdo, codigo_estudiante, condicion, cursos) AS SELECT VP.NOMBRE || ' ' || VP.SEDE AS NOMBRE_ESCUELA,
VP.NOMBRE_FACULTAD,
P.NOMBRE || ' ' || P.PATERNO || ' ' || P.MATERNO AS ESTUDIANTE,
AC.ID_ALUMNO_CONTRATO,
AC.CODIGO,
AC.ESTADO AS ESTADO_CONTRATO,
C.ID_ACUERDO_CONTRATO,
C.ESTADO AS ESTADO_ACUERDO,
pna.CODIGO AS codigo_estudiante,
C.CONDICION ,
(SELECT count(*) FROM ACUERDO_CONTRATO_CURSO WHERE ID_ACUERDO_CONTRATO=C.ID_ACUERDO_CONTRATO) AS cursos
FROM ACUERDO_CONTRATO C JOIN ACAD_ALUMNO_CONTRATO AC ON C.ID_ALUMNO_CONTRATO=AC.ID_ALUMNO_CONTRATO
JOIN MOISES.PERSONA P ON P.ID_PERSONA=AC.ID_PERSONA
JOIN ACAD_PLAN_PROGRAMA PP ON PP.ID_PLAN_PROGRAMA=AC.ID_PLAN_PROGRAMA
JOIN VW_ACAD_PROGRAMA_ESTUDIO VP ON VP.ID_PROGRAMA_ESTUDIO=PP.ID_PROGRAMA_ESTUDIO
JOIN MOISES.PERSONA_NATURAL_ALUMNO PNA ON PNA.ID_PERSONA=AC.ID_PERSONA;

