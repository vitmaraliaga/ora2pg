-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_escolas_div (id_escola, descricao, sigla, anio) AS select Distinct ape.Id_Facultad id_Escola,ape.Nombre_Facultad descricao,oa.Sigla,substr(asm.semestre,0,4) anio
FROM vw_Acad_Programa_Estudio ape
inner join ELISEO.Org_Area oa on oa.Id_Area=ape.Id_Facultad
inner join acad_semestre_programa asp on asp.id_programa_estudio=ape.id_programa_estudio
inner join acad_semestre asm on asm.id_semestre=asp.id_semestre
where ape.id_nivel_ensenanza in (1,2) and ape.Id_Facultad not in (676,777,150,673,309,308) and ape.estado='1'
and ape.Id_Escuela not in (228,234,255,253,164,419,179,181,196,197,188,189,190,191,192,193,194,195,180,236,235,232,204,168,169,166,165,219)
and ape.Id_Tipo_Contrato in (1,2,3,4)
and ape.Nombre_Certificado not like 'Unidad de Posgrado%'
order by substr(asm.semestre,0,4),ape.Id_Facultad;

