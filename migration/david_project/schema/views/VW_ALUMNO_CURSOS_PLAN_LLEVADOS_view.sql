-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_alumno_cursos_plan_llevados (id_persona, id_curso_alumno, id_plan_programa, id_carga_curso, id_curso_detalle, id_plan_curso, ciclo, curso, promedio, id_tipo_condicion, credito, id_plan) AS select apc.id_persona,apc.ID_CURSO_ALUMNO,vpp.ID_PLAN_PROGRAMA,apc.id_carga_curso,acp.id_curso_detalle,acp.ID_PLAN_CURSO,acp.ciclo,acp.CURSO, apc.promedio,apc.id_tipo_condicion,acp.credito,apc.id_plan
FROM VW_PLAN_PROGRAMA vpp inner join VW_ACAD_CURSO_PLAN acp on vpp.ID_PLAN=acp.ID_PLAN
inner join(
            select aca.id_persona,apc.id_plan,aca.ID_CURSO_ALUMNO,apc.id_curso_detalle,aca.ID_PLAN_CURSO,aca.promedio,aca.ID_CARGA_CURSO,aca.id_tipo_condicion
            from vw_acad_curso_plan apc
            inner join VW_CURSO_EQUIVALENTE vce on vce.ID_CURSO_DETALLE=apc.ID_CURSO_DETALLE
            inner join ACAD_CURSO_DETALLE acd on ACD.ID_CURSO_DETALLE=vce.CURSO_EQUIV and ACD.ID_AREA=apc.ID_PARENT
            inner join acad_curso_alumno aca on aca.ID_CURSO_DETALLE=vce.CURSO_EQUIV and aca.id_tipo_condicion <> 7 and aca.estado='1'
            where coalesce(apc.ID_PLAN_CURSO_ELECTIVO::text, '') = '' 
            
union

            select aca.id_persona,apce.id_plan,aca.ID_CURSO_ALUMNO,apc.id_curso_detalle,aca.ID_PLAN_CURSO,aca.promedio,aca.ID_CARGA_CURSO,aca.id_tipo_condicion
            from VW_ACAD_CURSO_PLAN apce inner join acad_plan_curso apc on apc.ID_PLAN_CURSO=APCE.ID_PLAN_CURSO_ELECTIVO
            inner join VW_CURSO_EQUIVALENTE vce on vce.ID_CURSO_DETALLE=apce.ID_CURSO_DETALLE
            inner join ACAD_CURSO_DETALLE acd on ACD.ID_CURSO_DETALLE=vce.CURSO_EQUIV and ACD.ID_AREA = apce.ID_PARENT
            inner join acad_curso_alumno aca on aca.ID_CURSO_DETALLE=vce.CURSO_EQUIV and aca.id_tipo_condicion <> 7 and aca.estado='1'
            where (apce.ID_PLAN_CURSO_ELECTIVO IS NOT NULL AND apce.ID_PLAN_CURSO_ELECTIVO::text <> '') ) apc on apc.ID_CURSO_DETALLE=acp.ID_CURSO_DETALLE and apc.id_plan=vpp.id_plan
where coalesce(acp.ID_PLAN_CURSO_ELECTIVO::text, '') = '' 
/*and VPP.ID_PLAN_PROGRAMA=1600 and apc.id_persona=61470
order by ciclo,ACP.CURSO*/
;

