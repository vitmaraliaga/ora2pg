-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_solicitud_alumno (nombres, codigo, id_solicitud_mat_alum, id_persona, id_tipo_solicitud_matricula, id_semestre, id_tipo_requisito_beca, estado, id_usuario_reg, fecha_registro, id_usuario_act, fecha_actualizacion, observacion, lista, id_matricula_detalle, id_plan_programa, id_programa_estudio, nombre_programa_estudio, nombre_semestre, codigo_solicitud, estado_nombre) AS SELECT DISTINCT
	PE.NOMBRE || ' ' || PE.PATERNO || ' ' || PE.MATERNO AS NOMBRES,
	PNA.CODIGO,
	SMA.ID_SOLICITUD_MAT_ALUM,SMA.ID_PERSONA,SMA.ID_TIPO_SOLICITUD_MATRICULA,SMA.ID_SEMESTRE,SMA.ID_TIPO_REQUISITO_BECA,SMA.ESTADO,SMA.ID_USUARIO_REG,SMA.FECHA_REGISTRO,SMA.ID_USUARIO_ACT,SMA.FECHA_ACTUALIZACION,SMA.OBSERVACION,SMA.LISTA,SMA.ID_MATRICULA_DETALLE,SMA.ID_PLAN_PROGRAMA,SMA.ID_PROGRAMA_ESTUDIO,
	VPE.NOMBRE AS NOMBRE_PROGRAMA_ESTUDIO,
	SE.NOMBRE AS NOMBRE_SEMESTRE,
	SMA.CODIGO,
	coalesce(TF.NOMBRE,'Sin estado') AS ESTADO_NOMBRE
	
	FROM SOLICITUD_MAT_ALUM SMA
	INNER JOIN MOISES.PERSONA PE ON SMA.ID_PERSONA=PE.ID_PERSONA
	INNER JOIN MOISES.PERSONA_NATURAL_ALUMNO PNA ON PNA.ID_PERSONA=PE.ID_PERSONA
	INNER JOIN ACAD_PLAN_PROGRAMA PP ON PP.ID_PLAN_PROGRAMA=SMA.ID_PLAN_PROGRAMA
	INNER JOIN VW_ACAD_PROGRAMA_ESTUDIO VPE ON VPE.ID_PROGRAMA_ESTUDIO=PP.ID_PROGRAMA_ESTUDIO
	INNER JOIN ACAD_SEMESTRE SE ON SE.ID_SEMESTRE=SMA.ID_SEMESTRE
	LEFT JOIN FILTRO_TIPO_TRAMITE FTT ON SMA.ID_TIPO_SOLICITUD_MATRICULA=FTT.ID_TIPO_SOLICITUD_MATRICULA AND FTT.VALOR=SMA.ESTADO
	LEFT JOIN TIPO_FILTRO TF ON TF.ID_TIPO_FILTRO=FTT.ID_TIPO_FILTRO;

