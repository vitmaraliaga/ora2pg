-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_persona_natural_carga (id_persona, nombre_tipo_documento, tipo_doc, num_documento, paterno, materno, nombre, apellido_nombre, codigo_sexo, sexo, codigo_religion, religion, pais, id_tipopais, discapacidad, nombre_apellido, celular, correo, correo_upeu) AS select p.id_persona,td.Nombre nombre_tipo_documento,td.Siglas tipo_doc,pn.Num_Documento,
p.paterno,p.materno,p.nombre , p.paterno||' '||p.materno||' '||p.nombre apellido_nombre,
Ts.Codigo codigo_sexo,Ts.Nombre sexo,Tr.Codigo codigo_religion,tr.nombre religion, 
tp.Nombre pais, pn.Id_Tipopais,nvl(Tdc.Nombre,'Ninguna') discapacidad,
p.nombre||' '||p.paterno||' '||p.materno nombre_apellido,pn.celular,pn.correo,pn.Correo_Inst correo_upeu
FROM moises.persona p inner join moises.persona_natural pn on pn.id_persona=p.id_persona
left join MOISES.Tipo_Sexo ts on ts.sexo=pn.sexo
left join moises.tipo_pais tp on tp.Id_Tipopais=pn.Id_Tipopais
left join moises.tipo_religion tr on Tr.Id_Tiporeligion=pn.Id_Tiporeligion
left join moises.tipo_documento td on td.Id_Tipodocumento=pn.Id_Tipodocumento
left join MOISES.Tipo_Discapacidad tdc on Tdc.Id_Tipo_Discapacidad=pn.Id_Tipo_Discapacidad;

