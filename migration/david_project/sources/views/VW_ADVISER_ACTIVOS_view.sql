-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_adviser_activos (id_programa_estudio, id_unidad_academica, id_sede, id_semipresencial, sede, nombre_facultad, nombre_escuela, id_semestre, mes, total) AS SELECT a.Id_Programa_Estudio, a.Id_Unidad_Academica,a.Id_Sede,a.id_semipresencial,
  	   a.sede,a.nombre_facultad, a.Nombre_Escuela, a.id_semestre, mes, count(*) FROM 
	(
		select distinct Ape.Id_Programa_Estudio, Ape.Id_Unidad_Academica,Ape.Id_Sede,ape.id_semipresencial,
	    ape.sede,ape.nombre_facultad, Ape.Nombre_Escuela, adt.id_semestre,
	    adt.ID_ADVISER ,EXTRACT(MONTH FROM as2.FECHA_SESION) AS mes 
		from adviser_tutorando adt 
		INNER JOIN ADVISER_SESION as2 ON adt.ID_ADVISER_TUTORANDO =as2.ID_ADVISER_TUTORANDO 
		inner join acad_Plan_Programa app on app.Id_Plan_Programa=adt.Id_Plan_Programa
	    inner join vw_Acad_Programa_Estudio ape on Ape.Id_Programa_Estudio=app.Id_Programa_Estudio
	    WHERE adt.estado <>'0' AND adt.ID_ADVISER_TUTORANDO IS NOT NULL 
	    ) a
    GROUP BY 
    a.Id_Programa_Estudio, a.Id_Unidad_Academica,a.Id_Sede,
	a.id_semipresencial,  a.sede,a.nombre_facultad, a.Nombre_Escuela, a.id_semestre, mes;

