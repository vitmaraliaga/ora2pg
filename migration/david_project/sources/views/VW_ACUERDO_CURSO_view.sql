-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_acuerdo_curso (id_alumno_contrato, id_carga_curso, id_alumno_contrato_curso, id_persona, estado_curso, estado_contrato) AS SELECT AC.ID_ALUMNO_CONTRATO, CA.ID_CARGA_CURSO, ID_ALUMNO_CONTRATO_CURSO, AC.id_persona,  
        ca.ESTADO AS estado_curso, AC.estado AS estado_contrato  
		FROM   ACAD_ALUMNO_CONTRATO_CURSO ACC  INNER JOIN
        ACAD_ALUMNO_CONTRATO AC ON AC.ID_ALUMNO_CONTRATO=ACC.ID_ALUMNO_CONTRATO INNER JOIN
        ACAD_CURSO_ALUMNO CA ON ACC.ID_CURSO_ALUMNO=CA.ID_CURSO_ALUMNO
        WHERE CA.ESTADO='1' AND AC.ESTADO='1' AND CA.ID_CARGA_CURSO IN (       
        SELECT ID_CARGA_CURSO FROM ACAD_CARGA_CURSO CC 
			INNER JOIN ACAD_SEMESTRE_PROGRAMA SP ON SP.ID_SEMESTRE_PROGRAMA=CC.ID_SEMESTRE_PROGRAMA
			INNER JOIN ACAD_SEMESTRE S ON S.ID_SEMESTRE=SP.ID_SEMESTRE
			WHERE S.ID_SEMESTRE=107 AND CC.ACUERDO=1)
		AND ACC.ID_ALUMNO_CONTRATO_CURSO NOT IN (
			SELECT ID_ALUMNO_CONTRATO_CURSO FROM ACUERDO_CONTRATO_CURSO CCU1 INNER JOIN 
				ACUERDO_CONTRATO AC1 ON AC1.ID_ACUERDO_CONTRATO=CCU1.ID_ACUERDO_CONTRATO INNER JOIN
				ACAD_ALUMNO_CONTRATO AC2 ON AC1.ID_ALUMNO_CONTRATO=AC2.ID_ALUMNO_CONTRATO
				where AC2.ID_PERSONA=AC.ID_PERSONA
	)	
	;

