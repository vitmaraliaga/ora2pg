-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_acad_persona_contrato (docente, num_documento, id_condicion_laboral, nombre, area, sede, semestre) AS SELECT DISTINCT p.NOMBRE || ' ' || p.PATERNO  || ' '|| p.MATERNO  AS  docente,
pn.NUM_DOCUMENTO ,
apc.ID_CONDICION_LABORAL,
cl.NOMBRE  ,
oa.NOMBRE  AS area,
se.NOMBRE  AS sede,
as2.NOMBRE  AS semestre
FROM ACAD_PERSONA_CONTRATO apc 
INNER JOIN ACAD_SEMESTRE as2 ON as2.ID_SEMESTRE = apc.ID_SEMESTRE 
INNER JOIN moises.CONDICION_LABORAL cl ON cl.ID_CONDICION_LABORAL =apc.ID_CONDICION_LABORAL 
INNER JOIN eliseo.ORG_SEDE_AREA osa ON osa.ID_SEDEAREA  = apc.ID_UNIDAD_ACADEMICA 
INNER JOIN eliseo.org_area oa ON oa.ID_AREA =osa.ID_AREA 
INNER JOIN eliseo.org_sede se ON se.ID_SEDE  = osa.ID_SEDE 
INNER JOIN ACAD_CARGA_CURSO_DOCENTE accd ON accd.ID_PERSONA = apc.ID_PERSONA 
inner join moises.persona p on p.id_persona=accd.id_persona
INNER JOIN moises.PERSONA_NATURAL pn ON pn.ID_PERSONA = p.ID_PERSONA 
INNER JOIN VW_ACAD_CARGA_ACADEMICA vaca ON vaca.ID_CARGA_CURSO = accd.ID_CARGA_CURSO AND vaca.ORIGEN ='O' and Vaca.Id_Nivel_Ensenanza in (1) and accd.Id_Factor<>3
AND vaca.ID_SEMESTRE =apc.ID_SEMESTRE;

