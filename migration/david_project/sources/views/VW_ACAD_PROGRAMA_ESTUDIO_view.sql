-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_acad_programa_estudio (id_programa_estudio, nombre_original, duracion, nombre_corto, nombre_certificado, min_cred_requeridos, max_cred_requeridos, nombre, id_sedearea, id_sede, sede, fac_sigla, id_facultad, nombre_facultad, nombre_escuela_cs, id_escuela, nombre_escuela, escuela, id_escuela_profesional, escuela_profesional, id_modalidad_estudio, modalidad_estudio, id_tipo_contrato, id_nivel_ensenanza, id_unidad_academica, id_semipresencial, id_sede_sem, id_area, id_parent, codigo, estado, alias, nombre_certificado_sunedu, codigo_nacional) AS select ape.id_programa_estudio,ape.nombre, ape.duracion, ape.nombre_corto,ape.NOMBRE_CERTIFICADO,ape.min_cred_requeridos, ape.max_cred_requeridos,
 decode(ape.ID_TIPO_CONTRATO , 24 , ape.Nombre_Certificado ||decode(asmp.id_semipresencial,null,'',' - '||asmp.nombre) || ', ' || tme.nombre,  ape.Nombre_Certificado||decode(asmp.id_semipresencial,null,'',' - '||asmp.nombre) || ', ' || tme.nombre) AS  nombre,
  -- ape.nombre,
  osa.id_sedearea, os.id_sede, os.nombre sede ,op.sigla fac_sigla,
nvl(decode(op.id_parent,8,8,null), op.id_area) id_facultad, decode(decode(op.id_parent,8,8,null),null,op.nombre,opp.nombre) nombre_facultad,
oa.nombre||decode(asmp.id_semipresencial,null,'',' - '||asmp.nombre) nombre_escuela_cs,
oa.id_area id_escuela , oa.nombre||decode(asmp.id_semipresencial,null,'',' - '||asmp.codigo) nombre_escuela,oa.nombre escuela,
ape.ID_ESCUELA_PROFESIONAL,nvl(nvl(nep.Nombre,pp.nombre),oa.Nombre) escuela_profesional
, tme.Id_Modalidad_Estudio, tme.Nombre modalidad_estudio, ape.id_tipo_contrato, ape.id_nivel_ensenanza,ape.Id_Unidad_Academica, 
asmp.id_semipresencial, asmp.id_sede id_sede_sem, osa.ID_AREA, op.ID_PARENT, ape.codigo,ape.estado, ape.alias,
ape.nombre_certificado_sunedu,ape.codigo_nacional
FROM acad_programa_estudio ape inner join eliseo.org_sede_area osa on osa.id_sedearea=ape.id_sedearea
inner join eliseo.org_sede os on Os.Id_Sede=osa.Id_Sede
inner join eliseo.org_area oa on oa.Id_Area=osa.Id_Area
left join eliseo.org_escuela_profesional ep on Ep.Id_Area=oa.Id_Area
left join (select osa.Id_Sedearea,oa.Nombre 
            from ELISEO.Org_Sede_Area osa 
            inner join ELISEO.Org_Area oa on oa.Id_Area=osa.Id_Area) pp on pp.Id_Sedearea=ape.ID_ESCUELA_PROFESIONAL
left join eliseo.org_area nep on nep.Id_Area=Ep.Id_Ep
left join eliseo.org_sede_area osaf on osaf.id_sedearea=ape.Id_Unidad_Academica
left join eliseo.org_area op on op.Id_Area=osaf.Id_Area--on op.Id_Area=oa.id_parent
left join eliseo.org_area opp on opp.Id_Area=decode(op.id_parent,8,8,null)
inner join Tipo_Modalidad_Estudio tme on tme.Id_Modalidad_Estudio=ape.Id_Modalidad_Estudio
left join acad_semipresencial asmp on asmp.id_semipresencial=ape.id_semipresencial;

