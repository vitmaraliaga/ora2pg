-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_tipo_cargo_ant(p_codigo_personal in varchar2,p_semestre in varchar2,p_tipo in varchar2) 
return varchar2
is
  p_resultado varchar2(500);
begin  

  Declare
    v_unidad_id varchar2(500);
    v_condicion_laboral varchar2(500);
    v_id_condicion_laboral varchar2(500);
    v_categoria varchar2(500);
    v_tiempo varchar2(500);

  begin
    
    select ''||unidad_id,
    decode(condicion_laboral,'00','Ninguno','C1','Contratado a Tiempo Completo','C2','Contratado a Tiempo Completo','C3','Contratado a Tiempo Completo','C4','Contratado a Tiempo Completo','C','Contratado a Tiempo parcial','E','Empleado','M','Misionero'),
    decode(condicion_laboral,'00','N','C1','CTC','C2','CTC','C3','CTC','C4','CTC','C','C','E','E','M','M'),
    decode(categoria,'PP','Profesor  Principal','PA','Profesor Asociado','PX','Profesor Auxiliar','PS','Profesor Asistente','JP','Jefe Practica','AU','Auxiliar','OT','Otros','NA','Ninguna','DC','Docente Contratado','DX','Docente Extraordinario') ,
    decode(tiempo,'00','Ninguno','DE','Dedicaci√≥n Exclusiva','TC','Tiempo Completo','TP','Tiempo Parcial') 
    into v_unidad_id,v_condicion_laboral,v_id_condicion_laboral,v_categoria,v_tiempo
    from profesor_cargo@dbl_noe
    where semestre=p_semestre
    and codigo_personal=p_codigo_personal;
    
    if(p_tipo='CL') then
      p_resultado := v_condicion_laboral;
    end if;
    if(p_tipo='ID') then
      p_resultado := v_id_condicion_laboral;
    end if;
    if(p_tipo='C') then
      p_resultado := v_categoria;
    end if;
    if(p_tipo='T') then
      p_resultado := v_tiempo;
    end if;
    if(p_tipo='U') then
      p_resultado := v_unidad_id;
    end if;
    
  end;
  
  return p_resultado;

end;

