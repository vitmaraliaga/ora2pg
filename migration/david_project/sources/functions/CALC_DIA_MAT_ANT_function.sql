-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

FUNCTION CALC_DIA_MAT_ant (P_CONTRATO VARCHAR2, P_FECHA DATE)
RETURN VARCHAR2
IS
DIA_CONTRATO VARCHAR2(3):=0;
BEGIN

    SELECT LPAD(X.CANT,2,0) INTO DIA_CONTRATO FROM (
    SELECT ROWNUM CANT, A.FECHA FROM (
        select distinct TO_CHAR(FECHA, 'DD/MM/YYYY') FECHA from AATEMP_ALUMNO_CONTRATO WHERE CODIGO_CONTRATO=P_CONTRATO
        AND ESTADO='1' and TO_CHAR(FECHA, 'DD/MM/YYYY') is not null group by TO_CHAR(FECHA, 'DD/MM/YYYY')) A ) X 
    WHERE X.FECHA=TO_CHAR(P_FECHA,'DD/MM/YYYY');

    RETURN DIA_CONTRATO;
END CALC_DIA_MAT_ant;

