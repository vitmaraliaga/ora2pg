-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_min_contrato_escuela(p_id_persona in integer,p_id_escuela in integer) 
return varchar2
is
  p_semestre varchar2(100);
begin

  select min(aac.Semestre) into p_semestre
  from vw_acad_alumno_contrato aac inner join vw_plan_programa vpp on VPP.ID_PLAN_PROGRAMA=AAC.ID_PLAN_PROGRAMA
  where aac.estado='1' and AAC.ID_MODO_CONTRATO=1 and id_persona=p_id_persona 
  and vpp.id_escuela=p_id_escuela and substr(aac.Semestre,-2) in ('-1','-2');
  
  return p_semestre;

end;

