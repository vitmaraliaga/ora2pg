-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

FUNCTION FT_CALC_DIA_MAT (P_ID_SEMESTRE VARCHAR2, P_FECHA DATE)
RETURN VARCHAR2
IS
DIA_CONTRATO VARCHAR2(3):=0;
BEGIN

    SELECT  LPAD(NUMERO,2,0) INTO DIA_CONTRATO 
    FROM (SELECT ROWNUM NUMERO, A.FECHA 
            FROM (select TO_CHAR(FECHA_registro,'YYYYMMDD') FECHA
                    from vw_acad_alumno_contrato where id_semestre=P_ID_SEMESTRE and estado='1'
                    GROUP BY TO_CHAR(FECHA_registro,'YYYYMMDD')
                    ORDER BY 1 ASC) A) X
    WHERE X.FECHA=TO_CHAR(P_FECHA,'YYYYMMDD');

    RETURN DIA_CONTRATO;
END;

