-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_calcular_promedio_estrat(v_id_carga_curso number, v_id_persona number, v_id_tipo_estrategia number)
return number
is
    promedio_final number;
begin
        
    select round(sum(nvl(aae.nota,0)*ace.ponderado)/sum(ace.ponderado),2) into  promedio_final
    from acad_carga_evaluacion ace 
    left join acad_alumno_evaluacion aae on ace.id_carga_evaluacion = aae.id_carga_evaluacion and aae.id_persona = v_id_persona
    left join acad_estrategia ae on ae.id_estrategia = ace.id_estrategia
    where ace.id_carga_curso = v_id_carga_curso
    and ae.id_tipo_estrategia=v_id_tipo_estrategia;

    return promedio_final;
end;

