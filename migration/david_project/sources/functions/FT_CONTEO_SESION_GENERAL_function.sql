-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_conteo_sesion_general(p_id_persona in integer,p_id_semestre in integer,
p_id_programa_estudio IN integer,
p_codigo_origen in integer,p_codigo_tipo_sesion IN integer,
p_mes IN integer

) 
return number
is
  p_contador number;
begin  
	
	 SELECT count(*) AS contador INTO p_contador FROM adviser_Sesion as2
        
        INNER JOIN ADVISER_TUTORANDO at2 ON as2.ID_PERSONA = at2.ID_PERSONA  AND at2.ID_SEMESTRE = as2.ID_SEMESTRE 
        INNER JOIN TUTORIA_ORIGEN to2 ON to2.id_tutoria_origen=as2.id_tutoria_origen
        INNER JOIN TUTORIA_TIPO_SESION tts2 ON tts2.ID_TUTORIA_TIPO_SESION =as2.ID_TUTORIA_TIPO_SESION 
        INNER JOIN ACAD_SEMESTRE as3 ON as3.ID_SEMESTRE =as2.ID_SEMESTRE 
        INNER JOIN ACAD_PLAN_PROGRAMA app ON app.ID_PLAN_PROGRAMA = at2.ID_PLAN_PROGRAMA 
         WHERE as2.ID_PERSONA IS NOT NULL 
        AND as2.id_usuario_reg=nvl(p_id_persona,as2.id_usuario_reg)
       AND to2.codigo=nvl(p_codigo_origen,to2.codigo)
        And  as2.id_semestre=nvl(p_id_semestre,as2.id_semestre) and at2.estado!='0'
        AND app.id_programa_estudio=nvl(p_id_programa_estudio,app.id_programa_estudio)
        AND tts2.codigo=nvl(p_codigo_tipo_sesion,tts2.codigo)
        AND extract(MONTH FROM as2.fecha_sesion)=nvl(p_mes, EXTRACT(MONTH FROM as2.fecha_sesion))
;

  
  return p_contador;
  
end;

