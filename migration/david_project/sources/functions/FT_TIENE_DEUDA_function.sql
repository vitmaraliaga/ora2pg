-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_tiene_deuda(v_id_persona integer,v_id_semestre integer)
return number
is
  p_res number;
  p_monto number;
  p_sem varchar2(50);
begin

  select Semestre into p_sem
  from acad_semestre 
  where Id_Semestre=v_id_semestre;

      select nvl((select substr(deuda,4) monto 
              from (select ft_deuda_alumno(v_id_persona,substr(p_sem,0,4)) deuda from dual)
              where substr(deuda,0,2)='01'),0) into p_monto
      from dual;
      
      if(p_monto>0) then
      
        p_res:=1;
        
      else
      
        p_res:=0;
      
      end if;
  
  return p_res;    
      
end;

