-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

function ft_verif_cursos_repetidos(v_id_persona integer, v_id_plan_programa integer, v_id_curso_detalle integer)
RETURN varchar2 IS
  p_id_area	  number;	
  p_res	  varchar2(100);		 

BEGIN
    
  select id_escuela into p_id_area from Vw_Plan_Programa where id_plan_programa=v_id_plan_programa;

  select distinct 'S' into p_res
  from vw_acad_curso_alumno aca inner join acad_plan_programa app on app.id_plan_programa=aca.id_plan_programa
                              and aca.id_persona=v_id_persona and aca.id_tipo_condicion=2 and aca.estado<>'4'
  inner join acad_plan ap on ap.id_plan=app.id_plan 
  inner join (select apc.curso from acad_plan_programa app inner join acad_plan ap on ap.id_plan=app.id_plan
              inner join vw_acad_curso_plan apc on apc.id_plan=ap.id_plan
              where id_plan_programa=v_id_plan_programa) nc on nc.curso=aca.nombre_curso
  inner join vw_curso_equivalente vce on vce.curso_equiv=aca.id_curso_detalle
  where ap.id_area=p_id_area
  and vce.id_curso_detalle=v_id_curso_detalle;

  
  return p_res;

END;

