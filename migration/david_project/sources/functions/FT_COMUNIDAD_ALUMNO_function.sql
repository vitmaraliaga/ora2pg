-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = david,public;
\set ON_ERROR_STOP ON

FUNCTION FT_COMUNIDAD_ALUMNO(V_ID_PERSONA IN INTEGER)RETURN VARCHAR2 AS 
p_direccion varchar2(4000);
BEGIN

SELECT max(direccion) into p_direccion
FROM MOISES.PERSONA_DIRECCION 
WHERE ID_PERSONA=V_ID_PERSONA
and (upper(direccion) like '%NATIVA%' 
OR (upper(direccion) like '%COMUNIDAD%' 
AND (UPPER(DIRECCION) LIKE '%ACHUAR%'
OR UPPER(DIRECCION) LIKE '%AIMARA%'
OR UPPER(DIRECCION) LIKE '%AMAHUACA%'
OR UPPER(DIRECCION) LIKE '%ARABELA%'
OR UPPER(DIRECCION) LIKE '%ASHANINKA%'
OR UPPER(DIRECCION) LIKE '%ASHENINKA%'
OR UPPER(DIRECCION) LIKE '%AWAJUN%'
OR UPPER(DIRECCION) LIKE '%BORA%'
OR UPPER(DIRECCION) LIKE '%CASHINAHUA%'
OR UPPER(DIRECCION) LIKE '%CHAMICURO%'
OR UPPER(DIRECCION) LIKE '%CHAPRA%'
OR UPPER(DIRECCION) LIKE '%CHITONAHUA%'
OR UPPER(DIRECCION) LIKE '%ESE%'
OR UPPER(DIRECCION) LIKE '%HARAKBUT%'
OR UPPER(DIRECCION) LIKE '%IKITU%'
OR UPPER(DIRECCION) LIKE '%IÑAPARI%'
OR UPPER(DIRECCION) LIKE '%INAPARI%'
OR UPPER(DIRECCION) LIKE '%ISKONAWA%'
OR UPPER(DIRECCION) LIKE '%JAQARU%'
OR UPPER(DIRECCION) LIKE '%JIBARO%'
OR UPPER(DIRECCION) LIKE '%KAKATAIBO%'
OR UPPER(DIRECCION) LIKE '%KAKINTE%'
OR UPPER(DIRECCION) LIKE '%KANDOZI%'
OR UPPER(DIRECCION) LIKE '%KAPANAWA%'
OR UPPER(DIRECCION) LIKE '%KICHWA%'
OR UPPER(DIRECCION) LIKE '%KUKAMA%'
OR UPPER(DIRECCION) LIKE '%MADIJA%'
OR UPPER(DIRECCION) LIKE '%MAIJUNA%'
OR UPPER(DIRECCION) LIKE '%MARINAHUA%'
OR UPPER(DIRECCION) LIKE '%MASHCO%'
OR UPPER(DIRECCION) LIKE '%MASTANAHUA%'
OR UPPER(DIRECCION) LIKE '%MATSES%'
OR UPPER(DIRECCION) LIKE '%MATSIGENKA%'
OR UPPER(DIRECCION) LIKE '%MUNICHE%'
OR UPPER(DIRECCION) LIKE '%MURUI%'
OR UPPER(DIRECCION) LIKE '%MUINANI%'
OR UPPER(DIRECCION) LIKE '%NAHUA%'
OR UPPER(DIRECCION) LIKE '%NANTI%'
OR UPPER(DIRECCION) LIKE '%NOMATSIGENGA%'
OR UPPER(DIRECCION) LIKE '%OCAINA%'
OR UPPER(DIRECCION) LIKE '%OMAGUA%'
OR UPPER(DIRECCION) LIKE '%QUECHUAS%'
OR UPPER(DIRECCION) LIKE '%RESIGARO%'
OR UPPER(DIRECCION) LIKE '%SECOYA%'
OR UPPER(DIRECCION) LIKE '%SHARANAHUA%'
OR UPPER(DIRECCION) LIKE '%SHAWI%'
OR UPPER(DIRECCION) LIKE '%SHIPIBO%'
OR UPPER(DIRECCION) LIKE '%KONIBO%'
OR UPPER(DIRECCION) LIKE '%SHIWILU%'
OR UPPER(DIRECCION) LIKE '%TICUNA%'
OR UPPER(DIRECCION) LIKE '%URARINA%'
OR UPPER(DIRECCION) LIKE '%URO%'
OR UPPER(DIRECCION) LIKE '%VACACOCHA%'
OR UPPER(DIRECCION) LIKE '%WAMPIS%'
OR UPPER(DIRECCION) LIKE '%YAGUA%'
OR UPPER(DIRECCION) LIKE '%YAMINAHUA%'
OR UPPER(DIRECCION) LIKE '%YANESHA%'
OR UPPER(DIRECCION) LIKE '%YINE%'
OR UPPER(DIRECCION) LIKE '%ARU%'
OR UPPER(DIRECCION) LIKE '%AMUNVAKA%'
OR UPPER(DIRECCION) LIKE '%CHIRIPUNO%'
OR UPPER(DIRECCION) LIKE '%ASHANINKA%'
OR UPPER(DIRECCION) LIKE '%AENTS%'
OR UPPER(DIRECCION) LIKE '%BOORAA%'
OR UPPER(DIRECCION) LIKE '%CAXINAHUA%'
OR UPPER(DIRECCION) LIKE '%CAMIKODLO%'
OR UPPER(DIRECCION) LIKE '%SHAPRA%'
OR UPPER(DIRECCION) LIKE '%MURUNAHUA%'
OR UPPER(DIRECCION) LIKE '%EJA%'
OR UPPER(DIRECCION) LIKE '%AMARAKAERI%'
OR UPPER(DIRECCION) LIKE '%AMACACORE%'
OR UPPER(DIRECCION) LIKE '%INAPARI%'
OR UPPER(DIRECCION) LIKE '%ISCONAHUA%'
OR UPPER(DIRECCION) LIKE '%AIMARA%'
OR UPPER(DIRECCION) LIKE '%CHIVARI%'
OR UPPER(DIRECCION) LIKE '%CASHIBO%'
OR UPPER(DIRECCION) LIKE '%CAQUINTE%'
OR UPPER(DIRECCION) LIKE '%CANDOSHI%'
OR UPPER(DIRECCION) LIKE '%BUSKIPANI%'
OR UPPER(DIRECCION) LIKE '%INGA%'
OR UPPER(DIRECCION) LIKE '%KUKAMIRIA%'
OR UPPER(DIRECCION) LIKE '%CULINA%'
OR UPPER(DIRECCION) LIKE '%MAIJIKI%'
OR UPPER(DIRECCION) LIKE '%ONOCOIN%'
OR UPPER(DIRECCION) LIKE '%PIRO%'
OR UPPER(DIRECCION) LIKE '%MATSANAHUA%'
OR UPPER(DIRECCION) LIKE '%MAYORUNA%'
OR UPPER(DIRECCION) LIKE '%MACHIGANGA%'
OR UPPER(DIRECCION) LIKE '%MUNICHI%'
OR UPPER(DIRECCION) LIKE '%HUITOTO%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%MATSIGENKA%'
OR UPPER(DIRECCION) LIKE '%ATIRI%'
OR UPPER(DIRECCION) LIKE '%DUKAIYA%'
OR UPPER(DIRECCION) LIKE '%ARIANA%'
OR UPPER(DIRECCION) LIKE '%CHOPCCAS%'
OR UPPER(DIRECCION) LIKE '%RESIGERO%'
OR UPPER(DIRECCION) LIKE '%AIDO%'
OR UPPER(DIRECCION) LIKE '%ONICOIN%'
OR UPPER(DIRECCION) LIKE '%PIYAPI%'
OR UPPER(DIRECCION) LIKE '%CONIVO%'
OR UPPER(DIRECCION) LIKE '%CHIOEO%'
OR UPPER(DIRECCION) LIKE '%CHEBERO%'
OR UPPER(DIRECCION) LIKE '%DUUXUGU%'
OR UPPER(DIRECCION) LIKE '%ITUCALI%'
OR UPPER(DIRECCION) LIKE '%URU%'
OR UPPER(DIRECCION) LIKE '%AEWA%'
OR UPPER(DIRECCION) LIKE '%HUAMBIZA%'
OR UPPER(DIRECCION) LIKE '%NIHAMWO%'
OR UPPER(DIRECCION) LIKE '%JJAMIMAWA%'
OR UPPER(DIRECCION) LIKE '%AMAGE%'
OR UPPER(DIRECCION) LIKE '%CHOTAQUIRO%'
OR UPPER(DIRECCION) LIKE '%KANA%'
OR UPPER(DIRECCION) LIKE '%KISAMBERI%'
OR UPPER(DIRECCION) LIKE '%PUKIRIERI%'
OR UPPER(DIRECCION) LIKE '%PUNCURI%'
OR UPPER(DIRECCION) LIKE '%QACHIPAERI%'
OR UPPER(DIRECCION) LIKE '%SAPITERI%'
OR UPPER(DIRECCION) LIKE '%SIWARO%'
OR UPPER(DIRECCION) LIKE '%TOIOERI%'
OR UPPER(DIRECCION) LIKE '%TOYERI%'
OR UPPER(DIRECCION) LIKE '%TOYOERI%'
OR UPPER(DIRECCION) LIKE '%TUYUNERI%'
OR UPPER(DIRECCION) LIKE '%WACHIPAERI%'
OR UPPER(DIRECCION) LIKE '%WACIPAIRI%'
OR UPPER(DIRECCION) LIKE '%SHIWIAR%'
OR UPPER(DIRECCION) LIKE '%QUECHUAS%'
OR UPPER(DIRECCION) LIKE '%PASTAZA%'
OR UPPER(DIRECCION) LIKE '%LLACUASH%'
OR UPPER(DIRECCION) LIKE '%QUICHUA%'
OR UPPER(DIRECCION) LIKE '%SANTARROSINOS%'
OR UPPER(DIRECCION) LIKE '%AHUAJUN%'
OR UPPER(DIRECCION) LIKE '%MIAMUNA%'
OR UPPER(DIRECCION) LIKE '%KUIN%'
OR UPPER(DIRECCION) LIKE '%CHAMICURA%'
OR UPPER(DIRECCION) LIKE '%PAJONAL%'
OR UPPER(DIRECCION) LIKE '%MIRANYA%'
OR UPPER(DIRECCION) LIKE '%MIRANHA%'
OR UPPER(DIRECCION) LIKE '%KACHINAHUA%'
OR UPPER(DIRECCION) LIKE '%TIATINAGUA%'
OR UPPER(DIRECCION) LIKE '%ARAZAERI%'
OR UPPER(DIRECCION) LIKE '%QUITURRAN%'
OR UPPER(DIRECCION) LIKE '%HUARAYO%'
OR UPPER(DIRECCION) LIKE '%ARASAIRI%'
OR UPPER(DIRECCION) LIKE '%IQUITO%'
OR UPPER(DIRECCION) LIKE '%KUSHITIRENI%'
OR UPPER(DIRECCION) LIKE '%HUACHIPAERI%'
OR UPPER(DIRECCION) LIKE '%AIMARA%'
OR UPPER(DIRECCION) LIKE '%JIBARO DEL RIO CORRIENTES%'
OR UPPER(DIRECCION) LIKE '%UNIBO%'
OR UPPER(DIRECCION) LIKE '%HUACHIPAYRI%'
OR UPPER(DIRECCION) LIKE '%CHAPRA%'
OR UPPER(DIRECCION) LIKE '%NUQUENCAIBO%'
OR UPPER(DIRECCION) LIKE '%COCAMILLA%'
OR UPPER(DIRECCION) LIKE '%KOLINA%'
OR UPPER(DIRECCION) LIKE '%MIRANA%'
OR UPPER(DIRECCION) LIKE '%MIRAÑA%'
OR UPPER(DIRECCION) LIKE '%CARAPANA%'
OR UPPER(DIRECCION) LIKE '%CARAPAÑA%'
OR UPPER(DIRECCION) LIKE '%PIRO%'
OR UPPER(DIRECCION) LIKE '%TAPUYO%'
OR UPPER(DIRECCION) LIKE '%TUPINO%'
OR UPPER(DIRECCION) LIKE '%MACHIGUENGA%'
OR UPPER(DIRECCION) LIKE '%MATSIGANGA%'
OR UPPER(DIRECCION) LIKE '%MATSIGUENGA%'
OR UPPER(DIRECCION) LIKE '%SHAPRA%'
OR UPPER(DIRECCION) LIKE '%MURATO%'
OR UPPER(DIRECCION) LIKE '%ARU%'
OR UPPER(DIRECCION) LIKE '%NAPO%'
OR UPPER(DIRECCION) LIKE '%YETE%'
OR UPPER(DIRECCION) LIKE '%CHANKAS%'
OR UPPER(DIRECCION) LIKE '%HUAYLAS%'
OR UPPER(DIRECCION) LIKE '%TSHAHUI%'
OR UPPER(DIRECCION) LIKE '%SHAYABIT%'
OR UPPER(DIRECCION) LIKE '%CHAYAWITA%'
OR UPPER(DIRECCION) LIKE '%SHIPIBO%'
OR UPPER(DIRECCION) LIKE '%SHIWILA%'
OR UPPER(DIRECCION) LIKE '%XEBERO%'
OR UPPER(DIRECCION) LIKE '%KACHA%'
OR UPPER(DIRECCION) LIKE '%AUSHIRI%'
OR UPPER(DIRECCION) LIKE '%ABISHIRA%'
OR UPPER(DIRECCION) LIKE '%SHUAR%'
OR UPPER(DIRECCION) LIKE '%YIHAMWO%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%AMUESHA%'
OR UPPER(DIRECCION) LIKE '%PIRO%'
OR UPPER(DIRECCION) LIKE '%AYMARA%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%TAPUEYOCUACA%'
OR UPPER(DIRECCION) LIKE '%HUAMPIS%'
OR UPPER(DIRECCION) LIKE '%KOLLINA%'
OR UPPER(DIRECCION) LIKE '%AGUARUNA%'
OR UPPER(DIRECCION) LIKE '%BORO%'
OR UPPER(DIRECCION) LIKE '%HUNI%'
OR UPPER(DIRECCION) LIKE '%CHAMICOLOS%'
OR UPPER(DIRECCION) LIKE '%KICHWARUNA%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%ESEEJJA%'
OR UPPER(DIRECCION) LIKE '%ARASAERI%'
OR UPPER(DIRECCION) LIKE '%IKITO%'
OR UPPER(DIRECCION) LIKE '%INAMARI%'
OR UPPER(DIRECCION) LIKE '%ISKOBAKEBO%'
OR UPPER(DIRECCION) LIKE '%CHIWARO%'
OR UPPER(DIRECCION) LIKE '%CACATAIBO%'
OR UPPER(DIRECCION) LIKE '%POYENISATI%'
OR UPPER(DIRECCION) LIKE '%CHAPARA%'
OR UPPER(DIRECCION) LIKE '%CAPANAHUA%'
OR UPPER(DIRECCION) LIKE '%KICHWA%'
OR UPPER(DIRECCION) LIKE '%COCAMA%'
OR UPPER(DIRECCION) LIKE '%KARINA%'
OR UPPER(DIRECCION) LIKE '%OREJON%'
OR UPPER(DIRECCION) LIKE '%MASHCO%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%XIBITAONA%'
OR UPPER(DIRECCION) LIKE '%MACHIGENGA%'
OR UPPER(DIRECCION) LIKE '%KULINO%'
OR UPPER(DIRECCION) LIKE '%UITOTO%'
OR UPPER(DIRECCION) LIKE '%LAMAS%'
OR UPPER(DIRECCION) LIKE '%MADIHA%'
OR UPPER(DIRECCION) LIKE '%NOMACHIGUENGA%'
OR UPPER(DIRECCION) LIKE '%DYOXAIYA%'
OR UPPER(DIRECCION) LIKE '%OMAGUA%'
OR UPPER(DIRECCION) LIKE '%HUANCAS%'
OR UPPER(DIRECCION) LIKE '%QEROS%'
OR UPPER(DIRECCION) LIKE '%PAI%'
OR UPPER(DIRECCION) LIKE '%YORA%'
OR UPPER(DIRECCION) LIKE '%CHAYAHUITA%'
OR UPPER(DIRECCION) LIKE '%JONI%'
OR UPPER(DIRECCION) LIKE '%JEBERO%'
OR UPPER(DIRECCION) LIKE '%TIKUNA%'
OR UPPER(DIRECCION) LIKE '%ITUKALE%'
OR UPPER(DIRECCION) LIKE '%CAÑARIS%'
OR UPPER(DIRECCION) LIKE '%CANARIS%'
OR UPPER(DIRECCION) LIKE '%ABIJIRA%'
OR UPPER(DIRECCION) LIKE '%MAINA%'
OR UPPER(DIRECCION) LIKE '%ÑIHAMWO%'
OR UPPER(DIRECCION) LIKE '%YAMINAGUA%'
OR UPPER(DIRECCION) LIKE '%AMAJO%'
OR UPPER(DIRECCION) LIKE '%PIRA%'
OR UPPER(DIRECCION) LIKE '%UNAWA%'
OR UPPER(DIRECCION) LIKE '%PARIANA%'
OR UPPER(DIRECCION) LIKE '%AWSHIRA%'
OR UPPER(DIRECCION) LIKE '%YUMINAHUA%'
OR UPPER(DIRECCION) LIKE '%AMUEXIA%'
OR UPPER(DIRECCION) LIKE '%PIRRO%'
OR UPPER(DIRECCION) LIKE '%OMAGE%'
OR UPPER(DIRECCION) LIKE '%SIMIRINCHE%')));

return p_direccion;

end;

