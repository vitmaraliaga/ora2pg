-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = jairo,pkg_planning,public;




CREATE OR REPLACE PROCEDURE jairo.pkg_planning_sp_iniciativa_asiento (P_ID_MAPA_INICIATIVA bigint,P_ID_DINAMICA bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) AS $body$
DECLARE

        L_ID_ACTIVIDAD bigint;
        L_CANT bigint :=0;

        CASI CURSOR FOR
        SELECT
                ID_ACTIVIDAD
        FROM SGE_ACTIVIDAD WHERE ID_MAPA_INICIATIVA = P_ID_MAPA_INICIATIVA 
        AND coalesce(PRESUPUESTO,0) > 0;

    
BEGIN
        P_ERROR :=0;
        IF P_ERROR = 0 THEN

            OPEN CASI;
                FETCH CASI INTO L_ID_ACTIVIDAD;
                WHILE CASI%FOUND LOOP

                    CALL pkg_planning_sp_actividad_asiento(L_ID_ACTIVIDAD,P_ID_DINAMICA,P_ERROR,P_MSGERROR);

                FETCH CASI INTO L_ID_ACTIVIDAD;

            END LOOP;
            CLOSE CASI;

            P_ERROR :=0;
        END IF;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE jairo.pkg_planning_sp_iniciativa_asiento (P_ID_MAPA_INICIATIVA bigint,P_ID_DINAMICA bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) FROM PUBLIC;
