-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = moises,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_ubigeo (id_ubigeo, departamento, provincia, distrito, ditto, pvcia, depto, codigo, ubigeo, latitud_ditto, longitud_ditto, latitud_pvcia, longitud_pvcia, latitud_depto, longitud_depto) AS SELECT di.ID_UBIGEO,
    de.nombre AS departamento,
    pr.nombre AS provincia,
    di.nombre AS distrito,
    di.DITTO,
    di.PVCIA,
    di.DEPTO,
    di.DEPTO||di.PVCIA||di.DITTO AS CODIGO,
    di.nombre|| ' - '||pr.nombre||' - '||de.nombre AS UBIGEO,
    di.Latitud_DITTO,di.Longitud_DITTO,
    pr.Latitud_PVCIA,pr.Longitud_PVCIA,
    de.Latitud_DEPTO,de.Longitud_DEPTO
   FROM moises.VW_DISTRITO di,
    moises.VW_PROVINCIA pr,
    moises.VW_DEPARTAMENTO de
  WHERE di.PVCIA = pr.PVCIA AND di.DEPTO = pr.DEPTO AND pr.DEPTO = de.DEPTO;

