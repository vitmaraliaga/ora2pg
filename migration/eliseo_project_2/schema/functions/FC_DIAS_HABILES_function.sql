-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fc_dias_habiles (FECHA timestamp(0)) RETURNS bigint AS $body$
DECLARE

FECHA_I timestamp(0);
DIAS bigint;
NRO_DIA bigint;
DIA_1 bigint;
FECHA_INI timestamp(0);

BEGIN
    DIAS := 0;
    SELECT TO_CHAR(TO_DATE(clock_timestamp()),'YYYY-MM')||'-01' INTO STRICT FECHA_INI
;

    IF FECHA >= FECHA_INI THEN
        WHILE FECHA_INI <= FECHA LOOP
            SELECT TO_CHAR(FECHA_INI,'D') INTO STRICT NRO_DIA 
;
            IF NRO_DIA = 1 OR NRO_DIA = 7 THEN
                DIA_1 :=0;
            ELSE
                DIAS := DIAS + 1;
            END IF;
            FECHA_INI := FECHA_INI + 1;
        END LOOP;
    ELSE
        DIAS :=0;
    END IF;

    RETURN DIAS;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fc_dias_habiles (FECHA timestamp(0)) FROM PUBLIC;

