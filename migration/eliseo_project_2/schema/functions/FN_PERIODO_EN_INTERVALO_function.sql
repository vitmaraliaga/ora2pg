-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fn_periodo_en_intervalo ( v_Anho bigint, v_Mes bigint, v_Inicio timestamp(0), v_Termino timestamp(0) ) RETURNS bigint AS $body$
DECLARE

  v_Resultado smallint;
  v_UltimoDia timestamp(0);
  v_PrimerDia timestamp(0);

BEGIN
  v_PrimerDia := '01/' || UTILS.CONVERT_TO_VARCHAR2(
    CASE
    WHEN v_Mes BETWEEN 1 AND 12 THEN
      v_Mes
    ELSE
      1
    END,2) || '/' || UTILS.CONVERT_TO_VARCHAR2(v_Anho,4);
  v_UltimoDia := utils.dateadd('DAY', -1, utils.dateadd('MONTH', 1, '01/' || UTILS.CONVERT_TO_VARCHAR2(
    CASE
    WHEN v_Mes BETWEEN 1 AND 12 THEN
      v_Mes
    ELSE
      12
    END,2) || '/' || UTILS.CONVERT_TO_VARCHAR2(v_Anho,4)));
  v_Resultado :=
  CASE
  WHEN coalesce(v_Inicio, v_UltimoDia) <= v_UltimoDia AND coalesce(v_Termino, v_PrimerDia) >= v_PrimerDia THEN
    1
  ELSE
    0
  END;
RETURN v_Resultado;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fn_periodo_en_intervalo ( v_Anho bigint, v_Mes bigint, v_Inicio timestamp(0), v_Termino timestamp(0) ) FROM PUBLIC;

