-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE FUNCTION eliseo.fc_psto_calc_mes_temporada (P_ID_TEMPORADA text) RETURNS bigint AS $body$
DECLARE

l_dato1 bigint:=0;
l_dato2 bigint:=0;
l_dato bigint:=0;
l_contar bigint:=0;
l_inicio bigint:=0;
l_fin bigint:=0;
l_inicio1 bigint:=0;
l_fin1 bigint:=0;

BEGIN

  select count(*) into STRICT  l_contar from PSTO_PLLA_TEMPORADA where id_temporada=P_ID_TEMPORADA;
  if l_contar =0 then
    l_dato:=0;
  else
    select INICIO,FIN,INICIO1,FIN1
    into STRICT l_inicio,l_fin,l_inicio1,l_fin1
    from PSTO_PLLA_TEMPORADA where id_temporada=P_ID_TEMPORADA;

    if l_inicio>0 and l_fin>0 then
      l_dato1:=(l_fin-l_inicio)+1;
    end if;
    if l_inicio1>0 and l_fin1>0 then
      l_dato2:=(l_fin1-l_inicio1)+1;
    end if;
    l_dato:=l_dato1+l_dato2;
	end if;

  if l_dato>12 then
    l_dato:=12;
  end if;

  if l_dato<0 then
    l_dato:=0;
  end if;

	RETURN(l_dato);
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.fc_psto_calc_mes_temporada (P_ID_TEMPORADA text) FROM PUBLIC;

