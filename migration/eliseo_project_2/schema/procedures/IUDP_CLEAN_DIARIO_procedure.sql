-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE PROCEDURE eliseo.iudp_clean_diario (P_ID_ENTIDAD integer, P_BEGIN_DATE text,P_END_DATE text) AS $body$
DECLARE

S_BEGIN_DATE   timestamp(0);
S_END_DATE  timestamp(0);

BEGIN
    S_BEGIN_DATE := to_date(P_BEGIN_DATE,'yyyy-mm-dd HH24:MI:SS');
    S_END_DATE := to_date(P_END_DATE,'yyyy-mm-dd HH24:MI:SS');

    
 
    delete from conta_diario_detalle
    where id_entidad = P_ID_ENTIDAD
    and ID_DIARIO in (
    SELECT id_diario from CONTA_DIARIO
        where ID_ENTIDAD = P_ID_ENTIDAD
        and FEC_CONTABILIZADO between S_BEGIN_DATE and S_END_DATE
    ) 
;

    delete from CONTA_DIARIO
    where ID_ENTIDAD = P_ID_ENTIDAD
    and FEC_CONTABILIZADO between S_BEGIN_DATE and S_END_DATE
;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.iudp_clean_diario (P_ID_ENTIDAD integer, P_BEGIN_DATE text,P_END_DATE text) FROM PUBLIC;

