-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_entidad_grupo (id_empresa, id_entidad, id_grupo, grupo) AS SELECT x.ID_EMPRESA, x.ID_ENTIDAD, x.ID_GRUPO, CASE WHEN ID_GRUPO = 1 THEN
'UPeU'
WHEN ID_GRUPO = 2 THEN 
'IASD NORTE'
--WHEN ID_GRUPO = 3 THEN 
--'P.UNIÓN'
WHEN ID_GRUPO = 3 THEN 
'RED EDUCATIVA'
WHEN ID_GRUPO = 4 THEN 
'ACES PERÚ'
WHEN ID_GRUPO = 5 THEN 
'SEHS NORTE'
WHEN ID_GRUPO = 6 THEN 
'NUEVO TIEMPO'
END AS GRUPO
FROM (SELECT ID_EMPRESA, ID_ENTIDAD, NOMBRE, ID_TIPOENTIDAD,
CASE WHEN ID_TIPOENTIDAD = 12 THEN
	1
	WHEN ID_TIPOENTIDAD = 3 OR ID_TIPOENTIDAD = 4  THEN
	2
WHEN ID_TIPOENTIDAD = 5 THEN
	3
	WHEN ID_TIPOENTIDAD = 7 THEN
	5
 	WHEN ID_TIPOENTIDAD = 9 THEN
	6
END AS ID_GRUPO 
FROM conta_entidad 
WHERE ID_ENTIDAD NOT IN (9119,17120,17122,
17123,17124,17125,17126,17127,17293,151111,17993) AND ID_TIPOENTIDAD NOT IN (13, 8) 

UNION ALL
 
SELECT ID_EMPRESA, ID_ENTIDAD, NOMBRE, ID_TIPOENTIDAD,
CASE 
--WHEN ID_ENTIDAD = 7128 THEN
	--3
	WHEN ID_ENTIDAD = 9415 THEN
	4
END AS ID_GRUPO
FROM conta_entidad 
WHERE ID_ENTIDAD NOT IN (7129, 7128) AND ID_TIPOENTIDAD = 13  
)x;

