-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_pto_deptos (id_entidad, id_depto, id_parent, nombre, es_grupo, es_activo, tipo, fac, eap, ciclos) AS select
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'GE' AS TIPO,
'' as FAC,
'' AS EAP,
0 as CICLOS
FROM conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN ('1','5','6') 

UNION

-------------RESIDENCIA------
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'RE' AS TIPO,
'' as FAC,
'' AS EAP,
0 as CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN (
'12020111',
'12020105',
'12020106'
) 

UNION

--CONSERVATORIO----
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'CO' AS TIPO,
'' as FAC,
'' AS EAP,
0 as CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN (
'11020401'
) 

UNION

--TALLER DE TESIS----
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'TT' AS TIPO,
'' as FAC,
'' AS EAP,
0 as CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN (
'13010701',
'13020701',
'13030701',
'13040701',
'13050701'
) 

UNION

--INGRESO PREGRADO----
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'IP' AS TIPO,
SUBSTR(ID_DEPTO,1,4) as FAC,
CASE WHEN  ID_DEPTO IN ('13020208') THEN '13020207'
    WHEN  ID_DEPTO IN ('13020209') THEN '13020201'
    WHEN  ID_DEPTO IN ('13020210') THEN '13020204'
    WHEN  ID_DEPTO IN ('13020211') THEN '13020203'
    WHEN  ID_DEPTO IN ('13020212') THEN '13020202'
    WHEN  ID_DEPTO IN ('13040205') THEN '13040201'
ELSE
  ID_DEPTO
END AS EAP,
CASE WHEN ID_DEPTO='13030204' THEN 14 ELSE 10 END AS CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN (
'13010202',
'13010201',
'13020203',
'13020211',
'13020207',
'13020208',
'13020202',
'13020212',
'13020201',
'13020209',
'13020204',
'13020210',
'13030201',
'13030204',
'13030202',
'13030203',
'13040203',
'13040201',
'13040201',
'13040205',
'13050201'
) 

UNION
   --PROESAD
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'PR' AS TIPO,
SUBSTR(ID_DEPTO,1,4) as FAC,
ID_DEPTO EAP,
10 CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO IN (
'13060201',
'13060202',
'13060203',
'13060204',
'13060205',
'13060206',
'13060207',
'13060208',
'13060209',
'13060210',
'13060211',
'13060212',
'13060213',
'13060214'
) 

union
 --admision
select 
ID_ENTIDAD, 
ID_DEPTO, 
ID_PARENT,
NOMBRE,
ES_GRUPO,
ES_ACTIVO,
'AD' AS TIPO,
'' as FAC,
'' AS EAP,
0 as CICLOS
from conta_entidad_depto
where id_entidad=7124 
AND ID_DEPTO  IN ('11020103','11020503','11020101');

