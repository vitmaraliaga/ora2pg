-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_entidad (id_empresa, id_ruc, id_corporacion, id_entidad, id_persona, id_tipoentidad, nombre, nom_empresa, nom_entidad, nom_tipoentidad) AS SELECT
  CONTA_ENTIDAD.ID_EMPRESA,
  CONTA_EMPRESA.ID_RUC,
  CONTA_EMPRESA.ID_CORPORACION,
  CONTA_ENTIDAD.ID_ENTIDAD,
  CONTA_ENTIDAD.ID_PERSONA,
  CONTA_ENTIDAD.ID_TIPOENTIDAD,
  CONTA_ENTIDAD.NOMBRE,
  Persona_Empresa.NOMBRE AS NOM_EMPRESA,
  coalesce(NULLIF(Persona.MATERNO, ''), coalesce(NULLIF(Persona.PATERNO, ''), Persona.NOMBRE)) NOM_ENTIDAD,
  Tipo_ENTIDAD.NOMBRE NOM_TIPOENTIDAD
FROM CONTA_ENTIDAD
INNER JOIN Tipo_ENTIDAD ON
  CONTA_ENTIDAD.ID_TIPOENTIDAD = Tipo_ENTIDAD.ID_TIPOENTIDAD
INNER JOIN MOISES.Persona ON
  CONTA_ENTIDAD.ID_PERSONA = Persona.ID_PERSONA
INNER JOIN CONTA_EMPRESA ON
  CONTA_ENTIDAD.ID_EMPRESA = CONTA_EMPRESA.ID_EMPRESA
INNER JOIN MOISES.Persona_Juridica ON
  CONTA_EMPRESA.ID_RUC = Persona_Juridica.ID_RUC
INNER JOIN MOISES.Persona Persona_Empresa ON
  Persona_Juridica.ID_PERSONA = Persona_Empresa.ID_PERSONA;

