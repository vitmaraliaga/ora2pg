-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_diario_temp (id_diario, id_empresa, id_entidad, id_anho, id_mes, id_tipoasiento, cod_aasi, fec_asiento, fec_digitado, fec_contabilizado, nom_digitador, nom_contador, id_fondo, id_tipoplan, id_cuentaaasi, id_restriccion, id_ctacte, id_depto, num_aasi, comentario, observacion, cos_valor, cos_dolar, codigo, orden, lote, debe, haber) AS SELECT
  CONTA_DIARIO_TEMP.ID_DIARIO,
  CONTA_ENTIDAD.ID_EMPRESA,
  CONTA_DIARIO_TEMP.ID_ENTIDAD,
  CONTA_DIARIO_TEMP.ID_ANHO,
  CONTA_DIARIO_TEMP.ID_MES,
  CONTA_DIARIO_TEMP.ID_TIPOASIENTO,
  CONTA_DIARIO_TEMP.COD_AASI,
  CONTA_DIARIO_TEMP.FEC_ASIENTO,
  CONTA_DIARIO_TEMP.FEC_DIGITADO,
  CONTA_DIARIO_TEMP.FEC_CONTABILIZADO,
  CONTA_DIARIO_TEMP.NOM_DIGITADOR,
  CONTA_DIARIO_TEMP.NOM_CONTADOR,
  CONTA_DIARIO_DETALLE_TEMP.ID_FONDO,
  CONTA_DIARIO_DETALLE_TEMP.ID_TIPOPLAN,
  CONTA_DIARIO_DETALLE_TEMP.ID_CUENTAAASI,
  CONTA_DIARIO_DETALLE_TEMP.ID_RESTRICCION,
  CONTA_DIARIO_DETALLE_TEMP.ID_CTACTE,
  CONTA_DIARIO_DETALLE_TEMP.ID_DEPTO,
  CONTA_DIARIO_DETALLE_TEMP.NUM_AASI,
  CONTA_DIARIO_DETALLE_TEMP.COMENTARIO,
  CONTA_DIARIO_DETALLE_TEMP.OBSERVACION,
  CONTA_DIARIO_DETALLE_TEMP.COS_VALOR,
  CONTA_DIARIO_DETALLE_TEMP.COS_DOLAR,
  CONTA_DIARIO_TEMP.ID_TIPOASIENTO || ' ' || CAST(CONTA_DIARIO_TEMP.COD_AASI AS varchar(10)) || '-' || CONTA_DIARIO_DETALLE_TEMP.NUM_AASI AS CODIGO,
  1 AS ORDEN,
  CAST(CONTA_DIARIO_TEMP.ID_ENTIDAD AS varchar(10)) || '-' || CONTA_DIARIO_TEMP.ID_TIPOASIENTO || ' ' || CAST(CONTA_DIARIO_TEMP.COD_AASI AS varchar(10)) AS LOTE,
  CASE WHEN CONTA_DIARIO_DETALLE_TEMP.COS_VALOR > 0 THEN ABS(round((CONTA_DIARIO_DETALLE_TEMP.COS_VALOR)::numeric, 2)) ELSE 0 END AS DEBE,
  CASE WHEN CONTA_DIARIO_DETALLE_TEMP.COS_VALOR < 0 THEN ABS(round((CONTA_DIARIO_DETALLE_TEMP.COS_VALOR)::numeric, 2)) ELSE 0 END AS HABER
FROM CONTA_ENTIDAD
INNER JOIN CONTA_DIARIO_TEMP ON
  CONTA_ENTIDAD.ID_ENTIDAD = CONTA_DIARIO_TEMP.ID_ENTIDAD
INNER JOIN CONTA_DIARIO_DETALLE_TEMP ON
  CONTA_DIARIO_TEMP.ID_ENTIDAD = CONTA_DIARIO_DETALLE_TEMP.ID_ENTIDAD AND
  CONTA_DIARIO_TEMP.ID_DIARIO = CONTA_DIARIO_DETALLE_TEMP.ID_DIARIO;

