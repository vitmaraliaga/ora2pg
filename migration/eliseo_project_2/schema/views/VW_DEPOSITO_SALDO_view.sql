-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_deposito_saldo (id_entidad, id_depto, id_deposito, serie_deposito, numero_deposito, id_moneda, total, total_me) AS SELECT
    	  ID_ENTIDAD,
          ID_DEPTO,
          ID_DEPOSITO,
          SERIE_DEPOSITO,
          NUMERO_DEPOSITO,
          --ID_CLIENTE,
          ID_MONEDA,
          coalesce(sum(CASE WHEN dc='D' THEN (TOTAL)  ELSE (TOTAL*-1) END ),0) AS TOTAL,
          coalesce(sum(CASE WHEN dc='D' THEN (TOTAL_ME)  ELSE (TOTAL_ME*-1) END ),0) AS TOTAL_ME
          --SUM(TOTAL) AS TOTAL,
          --SUM(TOTAL_ME) AS TOTAL_ME
    FROM ELISEO.VW_DEPOSITO_MOV
    GROUP BY ID_ENTIDAD,
          ID_DEPTO,
          ID_DEPOSITO,
          SERIE_DEPOSITO,
          NUMERO_DEPOSITO,
          --ID_CLIENTE,
          ID_MONEDA;

