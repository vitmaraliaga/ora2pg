-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_purchases,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_purchases_sp_save_step_a ( in_id_entidad bigint, in_id_depto text, in_id_tipopedido bigint, in_id_tipogasto bigint, in_id_deptoorigen text, in_id_deptodestino text, in_id_evento bigint, in_acuerdo text, in_motivo text, in_estado text, in_id_user bigint, in_id_proceso bigint, in_detalle text, in_id_paso bigint, in_id_paso_actual bigint, in_ip text, out_id_pedido out bigint, out_error out bigint, out_msgerror out text) AS $body$
DECLARE

        var_error bigint := 0;
        var_msgerror varchar(200) := ' ';
        var_id_registro bigint;
        var_id_detalle bigint;

BEGIN
            out_error := 0;
            out_msgerror := ' ';
            -- 
            CALL pkg_purchases_sp_insert_pedido_registro(
                in_id_entidad,
                in_id_depto,
                in_id_tipopedido,
                in_id_tipogasto,
                in_id_deptoorigen,
                in_id_deptodestino,
                in_id_evento,
                in_acuerdo,
                in_motivo,
                in_estado,
                out_id_pedido,
                var_error,
                var_msgerror);
            -- 
            if var_error>0 then
                out_error := var_error;
                out_msgerror := var_msgerror;
--                 goto end_l_save_step_a;
            end if;
            -- 
            CALL pkg_purchases_sp_insert_process_run(
                in_id_proceso,
                out_id_pedido,
                in_detalle,
                '1',
                in_id_paso,
                var_id_registro,
                var_error,
                var_msgerror);
            --
            if var_error>0 then
                out_error := out_error+var_error;
                out_msgerror := out_msgerror || var_msgerror;
--                 goto end_l_save_step_a;
            end if;
            --
            CALL pkg_purchases_sp_insert_process_paso_run(
                var_id_registro,
                in_id_paso,
                in_id_user,
                '',
                0,
                '',
                in_ip,
                '1',
                in_id_paso_actual,
                var_id_detalle,
                var_error,
                var_msgerror);
            -- 
            CALL pkg_purchases_sp_save_next_paso_run(
                in_id_proceso,
                out_id_pedido,
                in_id_user,
                '',
                0,
                '',
                in_ip,
                '1',
                var_id_detalle,
                var_error,
                var_msgerror);
            -- 
--             <<end_l_save_step_a>>
            NULL;
            -- 
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_purchases_sp_save_step_a ( in_id_entidad bigint, in_id_depto text, in_id_tipopedido bigint, in_id_tipogasto bigint, in_id_deptoorigen text, in_id_deptodestino text, in_id_evento bigint, in_acuerdo text, in_motivo text, in_estado text, in_id_user bigint, in_id_proceso bigint, in_detalle text, in_id_paso bigint, in_id_paso_actual bigint, in_ip text, out_id_pedido out bigint, out_error out bigint, out_msgerror out text) FROM PUBLIC;
