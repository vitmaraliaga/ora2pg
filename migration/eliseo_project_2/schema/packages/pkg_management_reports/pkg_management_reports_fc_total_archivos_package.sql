-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_management_reports,public;




CREATE OR REPLACE FUNCTION eliseo.pkg_management_reports_fc_total_archivos (P_ID_EMPRESA bigint, P_ID_ANHO bigint,P_ID_MES bigint, P_ID_TIPOARCHIVO bigint, P_ID_ENTIDAD bigint, P_ID_DEPTO text) RETURNS bigint AS $body$
DECLARE

    L_CANTIDAD bigint :=0;

BEGIN
    
	    IF coalesce(P_ID_DEPTO::text, '') = '' OR P_ID_DEPTO = 0 THEN
			SELECT count(*) INTO STRICT L_CANTIDAD 
			FROM ELISEO.ARCHIVO_MENSUAL am
			WHERE am.ID_EMPRESA = P_ID_EMPRESA
			AND am.ID_ANHO = P_ID_ANHO 
			AND am.ID_MES = P_ID_MES
			AND am.ID_TIPOARCHIVO = P_ID_TIPOARCHIVO
			AND am.ID_ENTIDAD = P_ID_ENTIDAD
			AND coalesce(am.ID_DEPTO::text, '') = '';
	    ELSE
			SELECT count(*) INTO STRICT L_CANTIDAD 
			FROM ELISEO.ARCHIVO_MENSUAL am
			WHERE am.ID_EMPRESA = P_ID_EMPRESA
			AND am.ID_ANHO = P_ID_ANHO 
			AND am.ID_MES = P_ID_MES
			AND am.ID_TIPOARCHIVO = P_ID_TIPOARCHIVO
			AND am.ID_ENTIDAD = P_ID_ENTIDAD
			AND am.ID_DEPTO = P_ID_DEPTO;
	    END IF;

        RETURN(L_CANTIDAD);
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION eliseo.pkg_management_reports_fc_total_archivos (P_ID_EMPRESA bigint, P_ID_ANHO bigint,P_ID_MES bigint, P_ID_TIPOARCHIVO bigint, P_ID_ENTIDAD bigint, P_ID_DEPTO text) FROM PUBLIC;
