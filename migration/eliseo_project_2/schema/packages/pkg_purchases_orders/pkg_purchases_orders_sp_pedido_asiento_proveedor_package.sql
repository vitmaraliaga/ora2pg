-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_purchases_orders,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_purchases_orders_sp_pedido_asiento_proveedor ( P_ID_PEDIDO integer, P_ERROR OUT bigint, P_MSGERROR OUT text ) AS $body$
DECLARE


        L_ID_DEPTO_CAMPUS varchar(10);
        L_ID_TIPOPLAN bigint := 1;
        L_ID_FONDO bigint := 10;
        L_ID_CUENTAAASI varchar(10) := '2130101';
        L_ID_RESTRICCION varchar(10) := '0A';
        L_ID_CTACTE varchar(10) := '1';
        L_ID_DEPTO varchar(10);
        L_DC varchar(1) := 'C';
        L_PORCENTAJE decimal(10,2) := 100;
        L_GLOSA varchar(100) := 'Cuenta Proveedores';
        L_INDICADOR varchar(100) := 'IMPORTE';
        L_AGRUPA varchar(1) := 'S';
        L_NRO_ASIENTO bigint := 1;
        L_EDITABLE varchar(1) := 'S';
        L_ID_TIPOPEDIDO integer;

        
        
BEGIN
            SELECT ID_DEPTO,ID_TIPOPEDIDO INTO STRICT L_ID_DEPTO_CAMPUS, L_ID_TIPOPEDIDO FROM PEDIDO_REGISTRO WHERE ID_PEDIDO = P_ID_PEDIDO;

            IF L_ID_TIPOPEDIDO BETWEEN 3 AND 6 THEN
                L_ID_CUENTAAASI := '3191005';
                L_GLOSA := 'Pedidos';
                IF L_ID_DEPTO_CAMPUS = 1 THEN
                    L_ID_DEPTO          := '11010101';
                ELSIF L_ID_DEPTO_CAMPUS = 3 THEN
                    L_ID_DEPTO          := '31010101';
                ELSIF L_ID_DEPTO_CAMPUS = 4 THEN
                    L_ID_DEPTO          := '41010101';
                ELSIF L_ID_DEPTO_CAMPUS = 5 THEN
                    L_ID_DEPTO          := '51010101';
                ELSIF L_ID_DEPTO_CAMPUS = 6 THEN
                    L_ID_DEPTO          := '61010101';
                ELSIF L_ID_DEPTO_CAMPUS = 7 THEN
                    L_ID_DEPTO          := '71010101';
                ELSE
                    L_ID_DEPTO          := '81010101';
                END IF;
            ELSIF L_ID_TIPOPEDIDO = 12 THEN
                L_GLOSA := 'Honorarios a Pagar';
                L_ID_CUENTAAASI := '2139020';
                IF L_ID_DEPTO_CAMPUS = 1 THEN
                    L_ID_DEPTO          := '11010101';
                ELSIF L_ID_DEPTO_CAMPUS = 3 THEN
                    L_ID_DEPTO          := '31010101';
                ELSIF L_ID_DEPTO_CAMPUS = 4 THEN
                    L_ID_DEPTO          := '41010101';
                ELSIF L_ID_DEPTO_CAMPUS = 5 THEN
                    L_ID_DEPTO          := '51010101';
                ELSIF L_ID_DEPTO_CAMPUS = 6 THEN
                    L_ID_DEPTO          := '61010101';
                ELSIF L_ID_DEPTO_CAMPUS = 7 THEN
                    L_ID_DEPTO          := '71010101';
                ELSE
                    L_ID_DEPTO          := '81010101';
                END IF;
            ELSE
                L_ID_CUENTAAASI := '2130101';
                IF L_ID_DEPTO_CAMPUS = 1 THEN
                    L_ID_DEPTO          := '11010101';
                ELSIF L_ID_DEPTO_CAMPUS = 3 THEN
                    L_ID_DEPTO          := '31010101';
                ELSIF L_ID_DEPTO_CAMPUS = 4 THEN
                    L_ID_DEPTO          := '41010101';
                ELSIF L_ID_DEPTO_CAMPUS = 5 THEN
                    L_ID_DEPTO          := '51010101';
                ELSIF L_ID_DEPTO_CAMPUS = 6 THEN
                    L_ID_DEPTO          := '61010101';
                ELSIF L_ID_DEPTO_CAMPUS = 7 THEN
                    L_ID_DEPTO          := '71010101';
                ELSE
                    L_ID_DEPTO          := '81010101';
                END IF;
            END IF;

            INSERT INTO PEDIDO_ASIENTO(ID_PEDIDO,
                                        ID_TIPOPLAN,
                                        ID_CUENTAAASI,
                                        ID_RESTRICCION,
                                        ID_FONDO,
                                        ID_CTACTE,
                                        ID_DEPTO,
                                        DC,
                                        PORCENTAJE,
                                        GLOSA,
                                        INDICADOR,
                                        AGRUPA,
                                        NRO_ASIENTO,
                                        EDITABLE)
                 VALUES (P_ID_PEDIDO,
                         L_ID_TIPOPLAN,
                         L_ID_CUENTAAASI,
                         L_ID_RESTRICCION,
                         L_ID_FONDO,
                         L_ID_CTACTE,
                         L_ID_DEPTO,
                         L_DC,
                         L_PORCENTAJE,
                         L_GLOSA,
                         L_INDICADOR,
                         L_AGRUPA,
                         L_NRO_ASIENTO,
                         L_EDITABLE);

                        P_ERROR :=0;
                        P_MSGERROR := 'OK';

        EXCEPTION
            WHEN OTHERS THEN
            P_MSGERROR := 'ERROR AL REGISTRAR ASIENTO'||SQLSTATE||' -ERROR- '||SQLERRM;
            P_ERROR :=1;

    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_purchases_orders_sp_pedido_asiento_proveedor ( P_ID_PEDIDO integer, P_ERROR OUT bigint, P_MSGERROR OUT text ) FROM PUBLIC;
