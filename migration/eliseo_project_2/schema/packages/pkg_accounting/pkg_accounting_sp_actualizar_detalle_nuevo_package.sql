-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_accounting,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_accounting_sp_actualizar_detalle_nuevo ( p_id_voucher text, p_error OUT bigint, p_msn OUT text ) AS $body$
DECLARE


        l_id_asiento     numeric(38);
        l_descripcion    varchar(4000);
        l_descripcion_02 varchar(4000);
        c_asiento CURSOR FOR
        SELECT
            id_asiento,
            descripcion,
            descripcion_02
        FROM
            eliseo.conta_asiento
        WHERE
            voucher = p_id_voucher;


BEGIN
        OPEN c_asiento;
        FETCH c_asiento INTO
            l_id_asiento,
            l_descripcion,
            l_descripcion_02;
        WHILE c_asiento%found LOOP
            IF coalesce(l_descripcion_02::text, '') = '' THEN
                l_descripcion_02 := pkg_accounting_fc_nueva_glosa_bancos(l_id_asiento);
                UPDATE conta_asiento
                SET
                    descripcion_02 = l_descripcion_02
                WHERE
                    id_asiento = l_id_asiento;

            END IF;

            FETCH c_asiento INTO
                l_id_asiento,
                l_descripcion,
                l_descripcion_02;
        END LOOP;

        CLOSE c_asiento;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_accounting_sp_actualizar_detalle_nuevo ( p_id_voucher text, p_error OUT bigint, p_msn OUT text ) FROM PUBLIC;
