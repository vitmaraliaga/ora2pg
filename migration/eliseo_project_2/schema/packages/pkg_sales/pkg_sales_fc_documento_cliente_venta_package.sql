-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_sales,public;




CREATE OR REPLACE FUNCTION eliseo.pkg_sales_fc_documento_cliente_venta (P_ID_CLIENTE bigint, ID_COMPROBANTE text) RETURNS bigint AS $body$
DECLARE

  v_resultado bigint := 0;

  datos RECORD;

BEGIN
  if ID_COMPROBANTE = '01' then
    for datos in ( 
                    SELECT  
                NUM_DOCUMENTO AS NOMBRE,
                ID_TIPODOCUMENTO
                FROM MOISES.VW_PERSONA_NATURAL
                WHERE ID_PERSONA=P_ID_CLIENTE 
                and ID_TIPODOCUMENTO = '6'
                
UNION all

                SELECT 
                    ID_RUC AS NOMBRE,
                    6 as ID_TIPODOCUMENTO
                FROM MOISES.VW_PERSONA_JURIDICA 
                WHERE ID_PERSONA=P_ID_CLIENTE
    ) loop  
    v_resultado := datos.nombre;
    end loop;
  ELSIF ID_COMPROBANTE = '03' then
  for datos in ( 
                    SELECT  
                NUM_DOCUMENTO AS NOMBRE,
                ID_TIPODOCUMENTO
                FROM MOISES.VW_PERSONA_NATURAL
                WHERE ID_PERSONA=P_ID_CLIENTE 
                and ID_TIPODOCUMENTO = '1' 
    ) loop  
    v_resultado := datos.nombre;
    end loop;
  ELSE
  v_resultado := 999;
  end if;
  RETURN v_resultado;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION eliseo.pkg_sales_fc_documento_cliente_venta (P_ID_CLIENTE bigint, ID_COMPROBANTE text) FROM PUBLIC;
