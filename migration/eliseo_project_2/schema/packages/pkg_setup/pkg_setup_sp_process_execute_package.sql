-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_setup,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_setup_sp_process_execute (P_ID_PROCESO bigint,P_ID_TIPOORIGEN bigint,P_ID_ORIGEN bigint,P_ID_PASO_ACTUAL bigint,P_ID_TASK bigint,P_DETALLE text,P_ID_EXECUTE OUT bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) AS $body$
DECLARE

            L_ID_EXECUTE bigint;
            L_ESTADO varchar(1) := '0';
        	L_ERROR bigint:=0;
	        L_MSGERROR varchar(200):='';
	        L_CONTAR bigint:=0;
	
        
BEGIN
                
            SELECT COUNT(1) INTO STRICT L_CONTAR FROM LAMB_PROCESS WHERE ID_PROCESO = P_ID_PROCESO;

            IF L_CONTAR > 0 THEN
                INSERT INTO LAMB_PROCESS_EXECUTE(ID_PROCESO,ID_TIPOORIGEN,ID_ORIGEN,ID_PASO_ACTUAL,ID_TASK,DETALLE,FECHA,ESTADO)VALUES (
                P_ID_PROCESO,P_ID_TIPOORIGEN,P_ID_ORIGEN,P_ID_PASO_ACTUAL,P_ID_TASK,P_DETALLE,clock_timestamp(),L_ESTADO
            )  RETURNING ID_EXECUTE INTO L_ID_EXECUTE;
            ELSE
                L_ERROR := 0;
                L_MSGERROR := 'ALTO: No existe proceso';
            END IF;

	       P_ERROR:= L_ERROR;
	       P_MSGERROR:= L_MSGERROR;
	       P_ID_EXECUTE := L_ID_EXECUTE;
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_setup_sp_process_execute (P_ID_PROCESO bigint,P_ID_TIPOORIGEN bigint,P_ID_ORIGEN bigint,P_ID_PASO_ACTUAL bigint,P_ID_TASK bigint,P_DETALLE text,P_ID_EXECUTE OUT bigint,P_ERROR OUT bigint,P_MSGERROR OUT text) FROM PUBLIC;
