-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';
SET search_path = eliseo,pkg_caja,public;




CREATE OR REPLACE PROCEDURE eliseo.pkg_caja_sp_actualizar_pago (P_ID_PAGO bigint,P_ID_CTABANCARIA bigint,P_ID_CHEQUERA bigint,P_ID_VALE bigint,P_ID_TIPOTRANSACCION bigint,P_ID_MONEDA bigint,P_TIPO_CAMBIO bigint,P_NUMERO text,P_ERROR OUT bigint,P_MSGERROR out text) AS $body$
DECLARE

        L_ID_CTABANCARIA bigint := null;
        L_ID_CHEQUERA bigint :=null;
        L_ID_VALE bigint :=null;
        L_ID_MONEDA bigint :=null;
        L_FECHA_CHEQUERA timestamp(0);

BEGIN
        IF coalesce(P_ID_CTABANCARIA::text, '') = '' OR P_ID_CTABANCARIA = 0 THEN
            L_ID_CTABANCARIA:=null;
        ELSE
            L_ID_CTABANCARIA:=P_ID_CTABANCARIA;
        END IF;
        IF coalesce(P_ID_CHEQUERA::text, '') = '' OR P_ID_CHEQUERA = 0 THEN
            L_ID_CHEQUERA:=null;
        ELSE
            L_ID_CHEQUERA:=P_ID_CHEQUERA;
             select TO_CHAR(fecha, 'DD/MM/YYYY') into STRICT L_FECHA_CHEQUERA from caja_chequera WHERE ID_CHEQUERA=P_ID_CHEQUERA;
        END IF;

        IF coalesce(P_ID_VALE::text, '') = '' OR P_ID_VALE = 0 THEN
            L_ID_VALE:=null;
        ELSE
            L_ID_VALE:=P_ID_VALE;
        END IF;

        IF coalesce(P_ID_MONEDA::text, '') = '' OR P_ID_MONEDA = 0 THEN
            L_ID_MONEDA:=null;
        ELSE
            L_ID_MONEDA:=P_ID_MONEDA;
        END IF;

        UPDATE CAJA_PAGO SET    ID_CTABANCARIA = L_ID_CTABANCARIA,
                                ID_CHEQUERA = L_ID_CHEQUERA,
                                ID_TIPOTRANSACCION = P_ID_TIPOTRANSACCION,
                                ID_MONEDA = L_ID_MONEDA,
                                TIPOCAMBIO = P_TIPO_CAMBIO,
                                NUMERO = P_NUMERO,
                                FECHA = L_FECHA_CHEQUERA,
                                ID_VALE = L_ID_VALE
                                --,ESTADO = '1'
        WHERE ID_PAGO = P_ID_PAGO;
        P_ERROR := 0;
        P_MSGERROR := 'PAGO FINALIZADO CON EXITO';
    END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE eliseo.pkg_caja_sp_actualizar_pago (P_ID_PAGO bigint,P_ID_CTABANCARIA bigint,P_ID_CHEQUERA bigint,P_ID_VALE bigint,P_ID_TIPOTRANSACCION bigint,P_ID_MONEDA bigint,P_TIPO_CAMBIO bigint,P_NUMERO text,P_ERROR OUT bigint,P_MSGERROR out text) FROM PUBLIC;
