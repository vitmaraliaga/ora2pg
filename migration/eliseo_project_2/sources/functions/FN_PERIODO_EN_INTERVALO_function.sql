-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

FUNCTION        fn_Periodo_En_Intervalo(
    v_Anho    IN NUMBER,
    v_Mes     IN NUMBER,
    v_Inicio  IN DATE,
    v_Termino IN DATE )
  RETURN NUMBER
AS
  v_Resultado NUMBER(1,0);
  v_UltimoDia DATE;
  v_PrimerDia DATE; 
BEGIN
  v_PrimerDia := '01/' || UTILS.CONVERT_TO_VARCHAR2
  (
    CASE
    WHEN v_Mes BETWEEN 1 AND 12 THEN
      v_Mes
    ELSE
      1
    END,2) || '/' || UTILS.CONVERT_TO_VARCHAR2(v_Anho,4) ;
  v_UltimoDia := utils.dateadd('DAY', -1, utils.dateadd('MONTH', 1, '01/' || UTILS.CONVERT_TO_VARCHAR2
  (
    CASE
    WHEN v_Mes BETWEEN 1 AND 12 THEN
      v_Mes
    ELSE
      12
    END,2) || '/' || UTILS.CONVERT_TO_VARCHAR2(v_Anho,4))) ;
  v_Resultado :=
  CASE
  WHEN NVL(v_Inicio, v_UltimoDia) <= v_UltimoDia AND NVL(v_Termino, v_PrimerDia) >= v_PrimerDia THEN
    1
  ELSE
    0
  END ;
RETURN v_Resultado;
END;

