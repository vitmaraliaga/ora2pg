-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

function FC_PSTO_CALC_MESES(P_FINI DATE,P_FFIN DATE,P_ID_ANHO NUMBER) RETURN NUMBER
IS
l_dato int:=0;
BEGIN
  if P_FINI is null then
    l_dato:=0;
  else
    if P_FFIN is null then
      SELECT MONTHS_BETWEEN (TO_DATE (TO_CHAR(P_ID_ANHO)||'/12/31', 'yyyy/mm/dd'),P_FINI) INTO l_dato from dual;
    else
      if P_FINI<P_FFIN then
        SELECT MONTHS_BETWEEN (P_FFIN,P_FINI) INTO l_dato from dual;
      end if;
    end if;
	end if;
  
  if l_dato>12 then
    l_dato:=12;
  end if;
  
  if l_dato<0 then
    l_dato:=0;
  end if;
  
	RETURN(l_dato);
END;

