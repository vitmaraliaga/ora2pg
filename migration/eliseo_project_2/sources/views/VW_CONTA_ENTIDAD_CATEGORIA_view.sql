-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_conta_entidad_categoria (id_empresa, id_entidad, id_categoria, categoria, color_base, color_secundario) AS SELECT x.ID_EMPRESA, x.ID_ENTIDAD, x.ID_CATEGORIA,
  CASE WHEN ID_CATEGORIA = 1 THEN 
	'UNION'
	WHEN ID_CATEGORIA = 2 THEN 
	'CAMPOS'
	WHEN ID_CATEGORIA = 3 THEN 
	'CAMPOS Y UNION'
	WHEN ID_CATEGORIA = 4 THEN 
	'IGLESIAS'
	WHEN ID_CATEGORIA = 5 THEN 
	'ASOCIACIÃ“N EDUCATIVA'
	WHEN ID_CATEGORIA = 6 THEN 
	'INSTITUCIONES'
	WHEN ID_CATEGORIA = 7 THEN 
	'UPEU'
	END AS CATEGORIA,
  CASE WHEN ID_CATEGORIA = 1 THEN 
	'rgb(46, 134, 193, 1)'
  	WHEN ID_CATEGORIA = 2 THEN 
	'rgb(46, 134, 193, 1)'
  	WHEN ID_CATEGORIA = 3 THEN 
	'rgb(46, 134, 193, 1)'
	WHEN ID_CATEGORIA = 4 THEN
	'rgb(36,100,68, 1)'
	WHEN ID_CATEGORIA = 5 THEN
	'rgb(0,57,111, 1)'
	WHEN ID_CATEGORIA = 6 THEN 
	'rgb(1,86,169, 1)'
	WHEN ID_CATEGORIA = 7 THEN 
	'rgb(46, 134, 193, 1)'
	END AS COLOR_BASE,
  CASE WHEN ID_CATEGORIA = 1 THEN 
	'rgb(174, 214, 241)'
  	WHEN ID_CATEGORIA = 2 THEN 
	'rgb(174, 214, 241)'
  	WHEN ID_CATEGORIA = 3 THEN 
	'rgb(174, 214, 241)'
	WHEN ID_CATEGORIA = 4 THEN 
	'rgb(205,205,205)'
	WHEN ID_CATEGORIA = 5 THEN 
	'rgb(247,245,247)'
	WHEN ID_CATEGORIA = 6 THEN 
	'rgb(254,213,1)'
	WHEN ID_CATEGORIA = 7 THEN 
	'rgb(174, 214, 241)'
	END AS COLOR_SECUNDARIO

FROM (SELECT ID_EMPRESA, ID_ENTIDAD, NOMBRE, ID_TIPOENTIDAD,
CASE WHEN ID_TIPOENTIDAD = 3 THEN
		1
	WHEN ID_TIPOENTIDAD = 4 AND  upper(NOMBRE) NOT LIKE upper('%IGLESIAS%') THEN
	2
	WHEN ID_TIPOENTIDAD = 4 AND  UPPER(NOMBRE) LIKE upper('%IGLESIAS%') THEN
		4
	WHEN ID_TIPOENTIDAD = 5 THEN
		5
	WHEN ID_TIPOENTIDAD = 7 OR ID_TIPOENTIDAD = 9 OR ID_TIPOENTIDAD = 13THEN
		6
 	WHEN ID_TIPOENTIDAD = 12 THEN
	7
END AS ID_CATEGORIA 
FROM conta_entidad 
WHERE ID_ENTIDAD NOT IN (9119,17120,17122,
17123,17124,17125,17126,17127, 7129) AND ID_TIPOENTIDAD != 8
UNION ALL
SELECT ID_EMPRESA, ID_ENTIDAD, NOMBRE, ID_TIPOENTIDAD,
CASE WHEN ID_TIPOENTIDAD = 3 OR (ID_TIPOENTIDAD = 4 AND  upper(NOMBRE) NOT LIKE upper('%IGLESIAS%'))   THEN
		3
END AS ID_CATEGORIA 
FROM conta_entidad 
WHERE ID_ENTIDAD NOT IN (9119,17120,17122,
17123,17124,17125,17126,17127, 7129) AND ID_TIPOENTIDAD IN (3,4) 
)x;

