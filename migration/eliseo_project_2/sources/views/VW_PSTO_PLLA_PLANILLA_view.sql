-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW vw_psto_plla_planilla (id_psto_planilla, id_anho, id_entidad, id_depto_padre, id_persona, id_categoria, id_depto, id_cargo, id_tipocontrato, id_auxiliar, uniforme, docente_tc, tipo_area, finicio, ffin, id_cond_lab, id_tiempotrabajo, ant_basico, ant_prima_inf, ant_modal_formativa, ant_boni_cargo, ant_asig_fam, ant_viv_remun, ant_sodexo, imp_boni_cargo, imp_asig_fam, imp_movi_lib_dis, imp_hextras25, imp_hextras35, imp_hnocturna, imp_hferiado, imp_viv_remun, imp_sodexo, imp_ayudaanual, imp_reint5tacat, cal_meses, cal_prima_inf, cal_sueldo, imp_basico, imp_modal_formativa, imp_prima_inf, imp_gratificacion, imp_bono_mis, imp_essalud, imp_uniforme, imp_boni_extra, imp_cts, imp_vac_trunca, imp_ppg, imp_seguro_vida, total, id_temporada, id_cargo_proceso, eshextras25, eshextras35, eshnocturna, eshferiado, fmr, imp_boni_cargo_men, imp_asig_fam_men, imp_movi_lib_dis_men, imp_hextras25_men, imp_hextras35_men, imp_hnocturna_men, imp_hferiado_men, imp_viv_remun_men, imp_sodexo_men, imp_ayudaanual_men, imp_reint5tacat_men, imp_basico_men, imp_modal_formativa_men, imp_prima_inf_men, imp_gratificacion_men, imp_bono_mis_men, imp_essalud_men, imp_uniforme_men, imp_boni_extra_men, imp_cts_men, imp_vac_trunca_men, imp_ppg_men, imp_seguro_vida_men) AS select 
ID_PSTO_PLANILLA,
ID_ANHO,
ID_ENTIDAD,
ID_DEPTO_PADRE,
ID_PERSONA,
ID_CATEGORIA,
ID_DEPTO,
ID_CARGO,
ID_TIPOCONTRATO,
ID_AUXILIAR,
UNIFORME,
DOCENTE_TC,
TIPO_AREA,
FINICIO,
FFIN,
ID_COND_LAB,
ID_TIEMPOTRABAJO,
ANT_BASICO,
ANT_PRIMA_INF,
ANT_MODAL_FORMATIVA,
ANT_BONI_CARGO,
ANT_ASIG_FAM,
ANT_VIV_REMUN,
ANT_SODEXO,
IMP_BONI_CARGO,
IMP_ASIG_FAM,
IMP_MOVI_LIB_DIS,
IMP_HEXTRAS25,
IMP_HEXTRAS35,
IMP_HNOCTURNA,
IMP_HFERIADO,
IMP_VIV_REMUN,
IMP_SODEXO,
IMP_AYUDAANUAL,
IMP_REINT5TACAT,
CAL_MESES,
CAL_PRIMA_INF,
CAL_SUELDO,
IMP_BASICO,
IMP_MODAL_FORMATIVA,
IMP_PRIMA_INF,
IMP_GRATIFICACION,
IMP_BONO_MIS,
IMP_ESSALUD,
IMP_UNIFORME,
IMP_BONI_EXTRA,
IMP_CTS,
IMP_VAC_TRUNCA,
IMP_PPG,
IMP_SEGURO_VIDA,
TOTAL,
ID_TEMPORADA,
ID_CARGO_PROCESO,
ESHEXTRAS25,
ESHEXTRAS35,
ESHNOCTURNA,
ESHFERIADO,
FMR,
COALESCE(IMP_BONI_CARGO,0) as IMP_BONI_CARGO_MEN,
COALESCE(IMP_ASIG_FAM,0) as IMP_ASIG_FAM_MEN,
COALESCE(IMP_MOVI_LIB_DIS,0) as IMP_MOVI_LIB_DIS_MEN,
COALESCE(IMP_HEXTRAS25,0) AS IMP_HEXTRAS25_MEN,
COALESCE(IMP_HEXTRAS35,0) AS IMP_HEXTRAS35_MEN,
COALESCE(IMP_HNOCTURNA,0) AS IMP_HNOCTURNA_MEN,
COALESCE(IMP_HFERIADO,0) AS IMP_HFERIADO_MEN,
COALESCE(IMP_VIV_REMUN,0) AS IMP_VIV_REMUN_MEN,
COALESCE(IMP_SODEXO,0) AS IMP_SODEXO_MEN,
COALESCE(IMP_AYUDAANUAL,0)/CAL_MESES AS IMP_AYUDAANUAL_MEN,
COALESCE(IMP_REINT5TACAT,0)/CAL_MESES AS IMP_REINT5TACAT_MEN,
COALESCE(IMP_BASICO,0) AS IMP_BASICO_MEN,
COALESCE(IMP_MODAL_FORMATIVA,0) AS IMP_MODAL_FORMATIVA_MEN,
COALESCE(IMP_PRIMA_INF,0) AS IMP_PRIMA_INF_MEN,
(COALESCE(IMP_GRATIFICACION,0)*2)/CAL_MESES AS IMP_GRATIFICACION_MEN,
COALESCE(IMP_BONO_MIS,0)/CAL_MESES AS IMP_BONO_MIS_MEN,
COALESCE(IMP_ESSALUD,0)/CAL_MESES AS IMP_ESSALUD_MEN,
COALESCE(IMP_UNIFORME,0)/CAL_MESES AS IMP_UNIFORME_MEN,
COALESCE(IMP_BONI_EXTRA,0)/CAL_MESES AS IMP_BONI_EXTRA_MEN,
COALESCE(IMP_CTS,0)/CAL_MESES AS IMP_CTS_MEN,
COALESCE(IMP_VAC_TRUNCA,0)/CAL_MESES AS IMP_VAC_TRUNCA_MEN,
COALESCE(IMP_PPG,0)/CAL_MESES AS IMP_PPG_MEN,
COALESCE(IMP_SEGURO_VIDA,0)/CAL_MESES AS IMP_SEGURO_VIDA_MEN
FROM PSTO_PLLA_PLANILLA;

