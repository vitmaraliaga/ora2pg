-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = eliseo,public;
\set ON_ERROR_STOP ON

PROCEDURE                                    SP_VENTA_ARREGLO (VENTA VARCHAR2)
IS
    L_ID_VDETALLE number;
    l_error number;
    l_msgerror varchar2(200);
 /*  CURSOR VENTA_DET
   IS
      SELECT DISTINCT ID_VENTA
        FROM ELISEO.VENTA_DETALLE
       WHERE ID_ARTICULO = 55564 
       AND OTROS_CARGOS = 0
       AND IMPORTE > 0
       ORDER BY ID_VENTA;*/
BEGIN
/*   OPEN VENTA_DET;

   FETCH VENTA_DET INTO L_ID_VDETALLE;

   WHILE VENTA_DET%FOUND
   LOOP
        SP_VENTA_BOLSA (L_ID_VDETALLE);
      */
        DELETE VENTA_ELECTRONICA
        WHERE ORIGENID = VENTA;
    
        DELETE UPEU_COMPROBANTE@DBL_ARON_APP
        WHERE ORIGENID = TO_CHAR(VENTA);
        
        --venta en el efact
        PKG_SALES.SP_VENTA_ELECTRONICA(VENTA,'07');
  /*       
        --ELIMINA ASIENTO
        DELETE CONTA_ASIENTO
        WHERE ID_TIPOORIGEN = 1
        AND ID_ORIGEN IN (
        SELECT ID_VDETALLE FROM VENTA_DETALLE
        WHERE ID_VENTA = L_ID_VDETALLE
        );
        
        --GENERAR ASIENTO
        PKG_SALES.SP_GENERAR_ASIENTO(L_ID_VDETALLE,l_error,l_msgerror);
      */
 
/*    FETCH VENTA_DET INTO L_ID_VDETALLE;
      
   END LOOP;

   CLOSE VENTA_DET;
*/
END SP_VENTA_ARREGLO;

