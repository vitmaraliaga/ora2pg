-- Generated by Ora2Pg, the Oracle database Schema converter, version 25.0
-- Copyright 2000-2025 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=10.174.11.5;sid=upeu;port=1521

SET client_encoding TO 'UTF8';

SET search_path = moises,public;
\set ON_ERROR_STOP ON





CREATE OR REPLACE PROCEDURE moises.iudp_person_natur_parent_mult ( P_Modo integer,PN_NUM_DOCUMENTO text, P_NUM_DOCUMENTO text, P_ID_TIPODOCUMENTO integer, P_ID_TIPOPARENTESCO integer, P_NOMBRE text, P_PATERNO text, P_MATERNO text, P_ID_ESTADOCIVIL integer, P_COD_PAIS integer, P_SEXO text, P_FEC_NACIMIENTO text, P_EMAIL text DEFAULT NULL, P_FIJO text DEFAULT NULL, P_CELULAR text DEFAULT NULL, P_RESIDENCIA text DEFAULT NULL, P_NUM_CUSPP text DEFAULT NULL) AS $body$
DECLARE


S_PN_NUM_DOCUMENTO varchar(100);
S_PN_ID_PERSONA integer := 0;
S_PR_ID_PERSONA integer;

BEGIN
  IF P_Modo = 0 THEN
  S_PN_NUM_DOCUMENTO := NULLIF(trim(both PN_NUM_DOCUMENTO),'');
  SELECT coalesce(
				(SELECT
					      coalesce(moises.Persona.ID_PERSONA, 0)
					    FROM moises.PERSONA
					    LEFT JOIN moises.Persona_Natural ON
					      Persona.ID_PERSONA = Persona_Natural.ID_PERSONA
					    LEFT JOIN moises.Persona_Documento ON
					      Persona.ID_PERSONA = Persona_Documento.ID_PERSONA
					    WHERE moises.Persona_Documento.NUM_DOCUMENTO = S_PN_NUM_DOCUMENTO)
				,0) INTO STRICT S_PN_ID_PERSONA;
  	S_PR_ID_PERSONA := 0;
    IF S_PN_ID_PERSONA IS NOT NULL AND S_PN_ID_PERSONA != 0 THEN
         CALL iudp_Persona_Natural(0, P_NUM_DOCUMENTO, P_ID_TIPODOCUMENTO, P_NOMBRE, P_PATERNO, P_MATERNO, P_ID_ESTADOCIVIL, NULL, P_COD_PAIS, P_COD_PAIS, NULL, P_SEXO, P_FEC_NACIMIENTO, NULL, S_PR_ID_PERSONA);
        CALL iudp_Persona_Virtual(0, S_PR_ID_PERSONA, 0, 1, P_EMAIL, NULL);
        CALL iudp_Persona_Telefono(0, S_PR_ID_PERSONA, 0, 1, P_FIJO, 0, 0, NULL);
        CALL iudp_Persona_Telefono(0, S_PR_ID_PERSONA, 0, 5, P_CELULAR, 0, 0, NULL);
        CALL iudp_Persona_Telefono(0, S_PR_ID_PERSONA, 0, 9, P_RESIDENCIA, 0, 0, NULL);
		CALL iudp_Persona_Documento(0, S_PR_ID_PERSONA, 98, P_NUM_CUSPP);
        CALL iudp_Persona_Natural_Parent(0,S_PN_ID_PERSONA, S_PR_ID_PERSONA, P_ID_TIPOPARENTESCO, NULL);
    END IF;
  END IF;
END;
$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE moises.iudp_person_natur_parent_mult ( P_Modo integer,PN_NUM_DOCUMENTO text, P_NUM_DOCUMENTO text, P_ID_TIPODOCUMENTO integer, P_ID_TIPOPARENTESCO integer, P_NOMBRE text, P_PATERNO text, P_MATERNO text, P_ID_ESTADOCIVIL integer, P_COD_PAIS integer, P_SEXO text, P_FEC_NACIMIENTO text, P_EMAIL text DEFAULT NULL, P_FIJO text DEFAULT NULL, P_CELULAR text DEFAULT NULL, P_RESIDENCIA text DEFAULT NULL, P_NUM_CUSPP text DEFAULT NULL) FROM PUBLIC;

